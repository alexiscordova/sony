include ../../../common/html/jade-helpers.jade
+includeCSS('search-results')
+includeCSS('recently-viewed')
+includeJavascriptModule('recently-viewed')


.featured-result
  p.p3.p3-bold.results
    span.bold-dark #{data.results.count}
    |  Results
  .sort-options.visible-phone
    form.select-narrow
      span.dropdown.dropdown-alt.ib
        button.lt4.btn.btn-small.dropdown-toggle.dropdown-toggle-alt(data-toggle="dropdown")
          span.js-toggle-text= data.narrowResultsSet[0].label
          i.fonticon-10-arrowheads-elevator
        ul.dropdown-menu.dropdown-menu-alt.pull-right(role="menu")
          each sort in data.narrowResultsSet
            li
              a(data-value=sort.name, tabindex="-1", href="#")= sort.label
      .native-dropdown
        select
        option.select-small= data.narrowResultsSet[0].label
          each sort in data.narrowResultsSet
            option(value=sort.name)= sort.label

  - data.view = "search-results"
  e = { "locals" : locals, "data" : data }
  !{locals.partial( 'packages/modules/product/html/product.jade', e )}

  .accessories-hd
    h4.l3= data.results.product.popularAccessoriesTitle
    .rv-module(data-break-early="true")
      .container.m-container
        .sony-carousel-wrapper
          .sony-carousel

            slides = [ [], [], [], [], [], [] ]
            each accessory, i in data.results.product.popularAccessories
              index = Math.floor( i / 6 )
              - slides[ index ].push( accessory )

            each slide in slides
              if slide.length > 0
                .sony-carousel-slide
                  .container
                    .slimgrid
                      each accessory in slide
                        d = accessory
                        - d.view = "simple"
                        e = { "locals" : locals, "data" : d }
                        !{locals.partial( accessory.type, e )}

ul.results-list
  each item in data.results.items
    li
      .media
        if item.image
          .media-img
            .img
              +iQImage(item.image)
        .bd
          .results-p
            h4.lt3
              a(href= item.url)= item.headline

            if item.question
              h5.lt4.italic-hd
                a(href= item.question.url)= item.question.text

            p.p4= item.body

            if item.related
              ul.h-list.h-list-md
                each link in item.related
                  li.lt4
                    a(href= link.url)= link.text
          i.fonticon-10-chevron
