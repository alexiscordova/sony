include ../../../common/html/jade-helpers.jade


mixin socialButton(link, label)
  .social-btn
    a.btn.btn-small(href= link)= label

mixin flickrContent(meta, images, btnLink, btnLabel)
  if (contentMode == "default")
    .top
      .icon-container
        .white-bg.fonticon-10-dot
        .left.fonticon-10-dot
        .right.fonticon-10-dot
        
      .meta.p4
        for info in meta
          if (info.user)
            span.user= info.user
            
          if (info.title)
            span= info.title

    .center
      .center-container
        .top-row
            - for (i = 0; i <= 2; i++) {
            if(images[i])
              div
                mixin iQImage(images[i])
            -}
        .bottom-row
            - for (i = 3; i <= 5; i++) {
            if(images[i])
              div
                mixin iQImage(images[i])
            -}
    .bottom
      mixin socialButton( btnLink, btnLabel )

mixin articleDefault (module)
  .img-container
    .img-wrap
      img.iq-img(alt= module.imgAltTxt, data-src= module.imgSrc)
      noscript
        img(src= module.noScriptImg)

mixin articleNews(module)
  .img-container
    .img-wrap
      img.iq-img(alt= module.imgAltTxt, data-src= module.imgSrc)
      noscript
        img(src= module.noScriptImg)
      p.news-date.l3-light= module.date

mixin articleEvent(module)
  .img-container.iq-img(data-src= module.imgSrc)
    .attendance-count
      .details
        p.t3= module.attendanceCount
        p.l3-light attending

mixin sonysVoiceTop(icon, meta)
  .icon-container
    .white-bg.fonticon-10-dot
    div(class=icon)
    
  .meta            
    p.p4    
      if (meta.user)
        span.user= meta.user

      if (meta.timestamp)
        span.timestamp= meta.timestamp


//- START Tertiary Content Container
section.tcc-wrapper.container.full-bleed-no-max.m-full-bleed(id=data.id, data-tcc-mode="#{data.moduleMode}")

  for header in data.header
    .tcc-header-wrapper.container
      //- .tcc-header.grid.m-full-bleed
      .tcc-header.grid
        p.tcc-header-title.l1 #{header.title}

        p.tcc-header-link.lt3
          a(href="#{header.link}") #{header.linkText}
  
  .loader
    img(src="img/global/loader.gif")

  - scrollerClassNames = ["tcc-scroller", "tcc-body-wrapper", "container", "tcc-full-bleed-at-979"]
  - bodyClassNames = ["tcc-body","grid"]

  section(class=scrollerClassNames)
    div(class=bodyClassNames)
      for module in data.contentModules
        - contentModulesClassNames = ["tcc-content-module","span4"]

        for variation in module.variations
          - contentType = variation.contentType
          - contentMode = variation.contentMode
          - contentModulesClassNames.push(contentMode, contentType)

          if(contentType != "users-voice")
            - contentModulesClassNames.push("table-center-wrap")

        div(class=contentModulesClassNames, data-tcc-content-type= contentType, data-tcc-content-mode= contentMode)
          case contentType
            when "article"
              if(contentMode == "featured") && (module.title) && (module.imgSrc)
                .featured-image.iq-img(data-src= module.imgSrc)
                article
                  .feature-copy.light-text-dark-box
                    p.t5-light= module.title
                    p.lt3
                      a(href= module.articleLink) Read More
              else                           
                if(contentMode == "default")
                  mixin articleDefault( module )

                if(contentMode == "news") && (module.date)
                  mixin articleNews( module )

                if(contentMode == "event") && (module.attendanceCount)
                  mixin articleEvent( module )

                .tcc-copy               
                  if (module.title)
                    p.p2
                      strong= module.title

                  if (module.bodyCopy)
                    p.p4= module.bodyCopy

                  if (module.articleLink)
                    p.lt3
                      a(href= module.articleLink) Read More


            when "users-voice"
              if (contentMode == "expert-quote")
                .title.l3= module.title

                blockquote.bq3
                  p= module.quote

                .credits
                  .avatar
                    img.iq-img(alt= module.avatarImgAltText, data-src= module.avatarImgSrc)
                      noscript
                        img(src= module.avatarNoScriptImg)
                
                  p.author.p4
                    a(href= module.authorLink)= module.author

              if (contentMode == "user-quote")
                .title.l3= module.title

                blockquote.bq3
                  p= module.quote

                .credits
                  .avatar
                    img.iq-img(alt= module.avatarImgAltText, data-src= module.avatarImgSrc)
                      noscript
                        img(src= module.avatarNoScriptImg)

                  p.handle.p4
                    a(href= module.authorLink)= module.authorHandle

                  p.author.p4= module.author

              if (contentMode == "question")
                .credits
                  .avatar
                    img.iq-img(alt= module.avatarImgAltText, data-src= module.avatarImgSrc)
                      noscript
                        img(src= module.avatarNoScriptImg)
                  
                  p.author.p4
                    a(href= module.authorLink)
                      | #{module.authorHandle} 
                    | #{module.title}
              
                blockquote.bq3
                  p
                    | #{module.question}

                p.lt3
                  a(href= module.repliesLink)
                    | See Replies

                .answer-btn
                  a.btn.btn-small(href= module.answerLink)
                    | Answer this Question
            
            when "sonys-voice"
              - iconName = "fonticon-15-" + contentMode


              if (contentMode != "instagram")
                .tcc-inner-container
                  .top
                    mixin sonysVoiceTop(iconName, module.meta)
                  .center
                    .center-container
                      if (contentMode == "twitter")
                        - label = "Follow Us on Twitter"

                        blockquote.bq4
                          p= module.quote

                      if (contentMode == "facebook")
                        - label = "Like Us on Facebook"
                        .post-tile
                          img.iq-img(alt= module.postImgAltText, data-src= module.postImg)
                            noscript
                              img(src= module.postImgNoScriptImg)

                        blockquote.post-copy.bq5
                            p= module.postCopy
                              a= module.postLink

                  .bottom
                    - link = module.socialBtnLink
                    mixin socialButton( link, label )


              if (contentMode == "instagram")
                .tcc-inner-container
                  .top
                    mixin sonysVoiceTop(iconName, module.meta)

                  .center
                    .center-container
                      div.left
                        div.iq-img(data-src= module.instagramTLImg)
                        div.last.iq-img(data-src= module.instagramBLImg)
                      div.right
                        div.iq-img(data-src= module.instagramRImg)
                  .bottom
                    mixin socialButton( module.socialBtnLink, "Follow Us on Instagram" )

            when "flickr"
              mixin flickrContent(module.meta, module.images, module.socialBtnLink, "View Set on Flickr")

//- END Tertiary Content Container


