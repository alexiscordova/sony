include ../../../common/html/jade-helpers.jade
+includeCSS('related-products-g1')
+includeJavascriptModule('related-products-g1')

layouts = locals.getConfigFile("packages/modules/related-products-g1/html/layouts.json")

moduleId = data.id ? data.id : false

mixin rpSlide( data )
  .rp-slide(class=data.config.variation, data-variation=data.config.variation)
    .shuffle-container.slimgrid5
      i = 0
      each module in data.submodules
        d = locals.data(module.data)
        - d.layout = layouts[data.config.layout][i++]
        - d.view = d.layout == 'blank-normal' ? 'blank' : 'basic'
        e = { 'locals' : locals , 'data' : d }
        !{locals.partial(module.type , e )}

mixin titleBlock( data )
  .container
    .grid
      if data.config.tabbedLayout
        .rp-tabs
          each tab, iterator in data.config.tabbedLayout
            panelId = iterator + 1
            a.rp-tab(class='lt4 no-hover-transition' , data-rp-panel-id=panelId, href='#')
              strong= tab.title

      else
        h2.l1= data.config.headerTitle

div(id=moduleId)
  if data.config.tabbedLayout
    +titleBlock( data )
    .rp-container-tabbed
      each slideContent, iterator in data.slideContent
        mode = data.config.mode
        panelId = iterator + 1
        section.related-products(class=mode, data-mode=mode, data-variation=data.config.variation,  data-rp-panel-id=panelId)
          .rp-overflow
            .rp-container
              j = 0
              for slide in slideContent
                mdata = locals.data(slide.data)
                +rpSlide( mdata )


  else if !data.config.standalone
    if data.config.mode == 'full'
      mode = data.config.mode
      +titleBlock( data )

      section.related-products( class=mode , data-mode=mode , data-variation=data.config.variation )
        .rp-overflow
          .rp-container
            j = 0
            for slide in data.slideContent
              mdata = locals.data(slide.data)
              +rpSlide( mdata )

  else if data.config.standalone
    if data.config.mode == 'full'
      mode = data.config.mode
      +titleBlock( data )

      section.related-products(class=mode , data-mode=mode , data-variation=data.config.variation)
        .rp-overflow
          .rp-container
            .rp-slide(class=data.config.variation , data-variation=data.config.variation)
              .shuffle-container.slimgrid5
                i = 0
                for module in data.submodules
                  d = locals.data(module.data)
                  - d.layout = layouts[data.config.layout][i++]
                  - d.view = d.layout == 'blank-normal' ? 'blank' : 'basic'
                  e = { 'locals' : locals , 'data' : d }
                  !{locals.partial(module.type , e )}

    else if data.config.mode == 'suggested'
      mode = data.config.mode
      +titleBlock( data )

      .container
        .grid
          section.related-products(class=mode , data-mode=mode , data-variation=data.config.variation)
            i = 0
            for module in data.submodules
              d = locals.data(module.data)
              - d.layout = layouts[data.config.layout][i++]
              - d.view = 'suggested'
              e = { 'locals' : locals , 'data' : d }
              !{locals.partial(module.type , e )}

    else if data.config.mode == 'strip'
      e = { 'locals' : locals , 'data' : data }
      !{locals.partial( 'packages/modules/recently-viewed/html/recently-viewed.jade', e) }













