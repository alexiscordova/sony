include ../../../common/html/jade-helpers.jade
+includeCSS('primary-tout-p1-d7')
+includeJavascriptModule('primary-tout-p1-d7')

mixin eyebrow(_data)
  d = _data ? _data : data
  if d.eyebrow
    if d.eyebrow.link
      a.l3.eyebrow(href= d.eyebrow.link)
        i.fonticon-10-chevron-reverse
        | !{locals.plusify(d.eyebrow.text)}

    else
      h2.l3.eyebrow!= locals.plusify(d.eyebrow.text)

mixin header(_data)
  d = _data ? _data : data
  h = d.headline ? locals.smallmark(d.headline) : ""
  if d.variation
    if d.variation.quote
      blockquote.bq1
        p!= d.quote
      p.p3!= d.byline
    else if d.variation.headertext == "smaller"
      h1.t2!= h
    else
      h1!= h
  else
    h1!= h

mixin bodytext(_data, _extra)
  d = _data ? _data : data
  e = _extra ? _extra : false
  if d.variation
    if d.variation.headertext == "larger"
      e = e + " hidden-phone"
  if d.body
    if data.mode == "homepage" || data.mode == "default"
      p.p2(class= e)!= d.body
    else
      p.p3(class= e)!= d.body

mixin links(_data, _extra)
  d = _data ? _data : data
  if d.links
    for link in d.links
      e = _extra ? _extra : false
      sm = link.submodule ? link.submodule : "0"
      if data.mode == "product-intro-plate"
        e = e + " lt3"
      case link.type
        when "btn"
          a(class= e)(class= "btn", href= link.url)!= link.text
        when "video"
          if data.mode != "product-intro-plate"
            e = e + " btn video"
          a(class= e)(href= link.url)(data-submodule = sm)
            i.fonticon-15-circle-play.l-o-d
            span!= link.text
        when "carousel"
          if data.mode != "product-intro-plate"
            e = e + " btn carousel"
          a(class= e)(href= link.url)(data-submodule = sm)
            i.fonticon-15-popup.l-o-d
            span!= link.text
        when "text"
          a(class= e)( href= link.url)!= link.text

mixin boxclass(_layout)
  layout = _layout ? _layout : data.layout
  .box(class = layout.alignment)
    block

mixin vbox()
  vert = "center"
  if data.layout
    if data.layout.valign
      vert  = data.layout.valign
  .table-center-wrap
   case vert
      when "top"
        .table-top
          block
      when "center"
        .table-center
          block
      when "bottom"
        .table-bottom
          block

mixin boxlayout(_layout, _style)
  layout = _layout ? _layout : data.layout
  classes = _style ? _style : data.style
  if data.variation
    if !data.variation.headline
      if data.variation.mobilealign
        classes = classes + " " + data.variation.mobilealign
      else
        classes = classes + " bottom"
  if layout.text == "left" || layout.text == "full"
    .container.inner(class= classes)
      .grid.no-grid-at-767
        - span = "span" + layout.columns[0]
        div(class= span)
          +vbox
            +boxclass
              block
  else if layout.text == "right" || layout.text == "center"
    .container.inner(class= classes)
      .grid.no-grid-at-767
        - span = "span" + layout.columns[1]
        - offset =  "offset" + layout.columns[0]
        div(class= span)(class= offset)
          +vbox
            +boxclass
              block

primaryToutClasses = ['primary-tout', data.mode, data.theme ]
+mainElement( primaryToutClasses)
  if data.mode != "title-plate"
    .hero-image
      e = {"locals":locals, "data":data.image}
      !{locals.partial('packages/modules/image/html/image.jade' , e)}

    if data.submodules.length > 0
      for sub, i in data.submodules
        .submodule.off-screen.visuallyhidden(class = data.links[i].type)
          button(class= "box-close box-close-small")
            i(class="fonticon-10-x")
          +partial(data.submodules[i].type, data.submodules[i].data, true)

  if data.mode == "homepage"
    if data.variation.secondbox
      +boxlayout
        +eyebrow
        +header
        .visible-phone
          +links
      .secondary.hidden-phone(class= data.variation.substyle)
        .box
          .container.grid.no-grid-at-767
            .span6
              +bodytext(data, "hidden-phone")
            .span4.offset2.clearfix
              +links(data, "pull-right")
    else
      +boxlayout
        +eyebrow
        +header
        +bodytext(data, "hidden-phone")
        +links
  else if data.mode == "default"
    style = data.style || false
    if data.variation
      if data.variation.mobilebg
        style = style + " force-mobile-bg"
      if data.variation.headline
        style = style + " no-bg"
    +boxlayout(data.layout, style)
      +eyebrow
      +header
      +bodytext
      +links
  else if data.mode == "product-intro-plate"
    +boxlayout
      +eyebrow
      h1.t2!= data.headline
      +bodytext
      +links(data, "hidden-phone")
    .mobile-buttons-wrap.container
      .grid.no-grid-at-767
        .mobile-buttons.clearfix
          +links(data, "visible-phone btn")
  else if data.mode == "title-plate"
    .hero-image.cover
      e = {"locals":locals, "data":data.image}
      if data.variation
        if data.variation.backgroundstyle
          if data.variation.backgroundstyle == "full-bleed"
            !{locals.partial('packages/modules/image/html/image.jade' , e)}
          else
            .image-module
      else
        !{locals.partial('packages/modules/image/html/image.jade' , e)}

    +boxlayout
      +eyebrow
      h1.t2!= locals.smallmark(data.headline)
      +bodytext(data, "hidden-phone")
      +links




