include ../../../common/html/jade-helpers.jade
+includeCSS('feature-slideshow-b1')
+includeJavascriptModule('feature-slideshow-b1')

//- Mixin for slides
mixin featureSlides(data)
  if data.submodules
    for slide in data.submodules
      slideData = locals.data( slide.data )
      +featureSlide( slideData )


mixin featureSlide( data )
  innerClasses = [ "fs-slide-inner" ]

  if !isSlideshowMode
    - innerClasses.push( "container" )

  .fs-slide.sony-fade-slide
    div(class=innerClasses)
      if data.img
        +iQBackgroundImage( data.img )
      +caption( data.caption )


mixin caption( caption )
  caption = caption ? caption : {}
  statValue = caption.stat && caption.stat.value ? caption.stat.value : "0.00"
  statUnit = caption.stat && caption.stat.unit ? caption.stat.unit : false
  statDescription = caption.description ? caption.description : "Finder terminal vmware fusion ios simulator firefox nightly webkit"
  toneColor = caption.stat && caption.stat.color ? caption.stat.color : "red"

  captionClasses = [ "caption" ]

  if isSlideshowMode
    - captionClasses.push( "container" )

  div(class=captionClasses)
    .media.caption-inner
      div(class=[ "pull-left", "text-center", "stat-wrap", "js-even-col" ])
        .table-center-wrap.v-wrap
          .table-center(class="text-" + toneColor)
            span.t2-light.stat.value !{ statValue }
            if statUnit
              span.p4.stat.unit !{ statUnit }
      .media-body.caption-body.table-center-wrap.js-even-col
        .table-center
          p.t5-light.text-dark !{ statDescription }


mixin copyGrid( data )
  copyStyle = data.style ? data.style : "dark-text-trans-box"

  div(class=[ "grid", "no-grid-at-767", copyStyle ])
    .span6.box.js-copy.fade
      block


mixin copyBlock( data )
  titleClass = isSlideshowMode ? "t3-bold" : "t2"
  subtitleClass = isSlideshowMode ? "t7" : "t6"
  bodyClass = isSlideshowMode ? "p3" : "p2"
  linkClass = isSlideshowMode ? "lt2" : "lt3"

  +copyGrid( data )
    if data.title
      h2(class=titleClass) !{data.title}
    if data.subtitle
      h3(class=subtitleClass) !{data.subtitle}
    if data.body
      p(class=bodyClass) !{data.body}
  if data.link
    .link
      linktextsize = data.link.type == "txt" ? linkClass : ""
      +link(data.link, [data.link.type, linktextsize])
  else if data.addon
    e = { "locals" : locals, "data" : data.addon }
    !{ locals.partial('packages/modules/addon/html/addon.jade', e) }


//- Default mode to slideshow
isSlideshowMode = data.mode && data.mode != "editorial"
mode = data.mode ? data.mode : "slideshow"
mode = "fs-" + mode

crossfade = data.crossfade ? data.crossfade : false
threshold = data.threshold ? data.threshold : false
delay = data.delay ? data.delay : false

//- Main section wrapper for slides
+mainElement( [ "fs-module", mode, "animation-pending" ] )
  if data.backdrop
    +iQBackgroundImage( data.backdrop, 'update-always fs-backdrop' )
  .container.copy-grid
    +copyBlock( data )
  .fs-carousel-wrapper.sony-fade-wrapper
    .fs-carousel.sony-fade(data-crossfade=crossfade, data-delay=delay, data-threshold=threshold)
      +featureSlides( data )









