<!DOCTYPE html>  <html> <head>   <title>editorial-chapters-e5.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="SEN-convergence-e12.html">                 SEN-convergence-e12.js               </a>                                           <a class="source" href="alert-module.html">                 alert-module.js               </a>                                           <a class="source" href="country-region-selection-z10.html">                 country-region-selection-z10.js               </a>                                           <a class="source" href="demo-x99.html">                 demo-x99.js               </a>                                           <a class="source" href="360viewer-controller.html">                 360viewer-controller.js               </a>                                           <a class="source" href="editorial-carousel-e13.html">                 editorial-carousel-e13.js               </a>                                           <a class="source" href="editorial-chapters-e5.html">                 editorial-chapters-e5.js               </a>                                           <a class="source" href="editorial-dual-viewer-e9.html">                 editorial-dual-viewer-e9.js               </a>                                           <a class="source" href="editorial-feature-list.html">                 editorial-feature-list.js               </a>                                           <a class="source" href="hotspots-controller.html">                 hotspots-controller.js               </a>                                           <a class="source" href="image-sequence.html">                 image-sequence.js               </a>                                           <a class="source" href="editorial-layouts-e1.html">                 editorial-layouts-e1.js               </a>                                           <a class="source" href="editorial-slideshows-e4.html">                 editorial-slideshows-e4.js               </a>                                           <a class="source" href="feature-slideshow.html">                 feature-slideshow.js               </a>                                           <a class="source" href="footnotes-module.html">                 footnotes-module.js               </a>                                           <a class="source" href="gallery-g2-g3.html">                 gallery-g2-g3.js               </a>                                           <a class="source" href="global-header-footer.html">                 global-header-footer.js               </a>                                           <a class="source" href="light-compare-d9.html">                 light-compare-d9.js               </a>                                           <a class="source" href="one-sony-carousel-s2.html">                 one-sony-carousel-s2.js               </a>                                           <a class="source" href="pdp-slideshow-d4.html">                 pdp-slideshow-d4.js               </a>                                           <a class="source" href="primary-tout-p1-d7.html">                 primary-tout-p1-d7.js               </a>                                           <a class="source" href="product-details-d5.html">                 product-details-d5.js               </a>                                           <a class="source" href="product-summary-d1-d2.html">                 product-summary-d1-d2.js               </a>                                           <a class="source" href="recently-viewed.html">                 recently-viewed.js               </a>                                           <a class="source" href="related-products-g1.html">                 related-products-g1.js               </a>                                           <a class="source" href="reviews-awards-d6.html">                 reviews-awards-d6.js               </a>                                           <a class="source" href="search-results-z07.html">                 search-results-z07.js               </a>                                           <a class="source" href="secondary-touts-s1-s4.html">                 secondary-touts-s1-s4.js               </a>                                           <a class="source" href="sony-video.html">                 sony-video.js               </a>                                           <a class="source" href="spec-multi-z2.html">                 spec-multi-z2.js               </a>                                           <a class="source" href="spec-single-z1.html">                 spec-single-z1.js               </a>                                           <a class="source" href="subnavigation-n4.html">                 subnavigation-n4.js               </a>                                           <a class="source" href="tertiary-t1-t5-module.html">                 tertiary-t1-t5-module.js               </a>                                           <a class="source" href="universal-nav.html">                 universal-nav.js               </a>                                           <a class="source" href="unsupported-z19.html">                 unsupported-z19.js               </a>                                           <a class="source" href="ux-marketing-convergence-e14.html">                 ux-marketing-convergence-e14.js               </a>                                           <a class="source" href="whats-new-tout-s4.html">                 whats-new-tout-s4.js               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               editorial-chapters-e5.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre><span class="comment">/*jshint debug:true */</span>

</pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <h2>Editorial SlideShow - E5</h2>

<ul>
<li><strong>Module:</strong> Editorial Chapters - E5</li>
<li><strong>Version:</strong> 1.0a</li>
<li><strong>Modified:</strong> 06/12/2013</li>
<li><strong>Author:</strong> Kaleb White</li>
<li><strong>Dependencies:</strong> jQuery 1.9.1+, Modernizr</li>
</ul>

<p><em>Example Usage:</em></p>

<pre><code> $('.editorial-chapters').EditorialChapters();
</code></pre>             </td>             <td class="code">               <div class="highlight"><pre>
define(<span class="keyword">function</span>(require){

   <span class="string">'use strict'</span>;

    <span class="keyword">var</span> $ = require(<span class="string">'jquery'</span>),
        iQ = require( <span class="string">'iQ'</span> ),
        Router = require(<span class="string">'require/sony-global-router'</span>),
        Modernizr = require(<span class="string">'modernizr'</span>),
        bootstrap = require(<span class="string">'bootstrap'</span>),
        Settings = require(<span class="string">'require/sony-global-settings'</span>),
        Environment = require(<span class="string">'require/sony-global-environment'</span>),
        sonyEvenHeights = require(<span class="string">'secondary/index'</span>).sonyEvenHeights,
        sonyCarouselFade = require(<span class="string">'secondary/index'</span>).sonyCarouselFade,
        sonyScroller = require(<span class="string">'secondary/index'</span>).sonyScroller;

    <span class="keyword">var</span> self = {
      <span class="string">'init'</span>: <span class="keyword">function</span>() {
        $(<span class="string">'.editorial-chapters-container'</span>).editorialChapters();
      }
    };

    <span class="keyword">var</span> EditorialChapters = <span class="keyword">function</span>(element, options){
      <span class="keyword">var</span> self = <span class="keyword">this</span>;

</pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>Extend</p>             </td>             <td class="code">               <div class="highlight"><pre>      $.extend( self, {}, $.fn.editorialChapters.defaults, options, $.fn.editorialChapters.settings );

</pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>Set base element</p>             </td>             <td class="code">               <div class="highlight"><pre>      self.$el = $( element );

</pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>Modernizr vars</p>             </td>             <td class="code">               <div class="highlight"><pre>      self.hasTouch             = Modernizr.touch;
      self.transitionDuration   = Modernizr.prefixed(<span class="string">'transitionDuration'</span>);
      self.cssTransitions       = Modernizr.transitions;
      self.useCSS3              = Modernizr.csstransforms &amp;&amp; Modernizr.csstransitions;

</pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>Basic selectors</p>             </td>             <td class="code">               <div class="highlight"><pre>      self.$doc                   = Settings.$document;
      self.$win                   = Settings.$window;
      self.$html                  = Settings.$html;

</pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>Cache some jQuery objects we'll reference later</p>             </td>             <td class="code">               <div class="highlight"><pre>      self.$ev                  = $({});
      self.$window              = Settings.$window;
      self.$slides              = self.$el.find(<span class="string">'.editorial-carousel-slide.chapter-slide'</span>);
      self.$slideWrapper        = self.$el.find(<span class="string">'.editorial-carousel-wrapper.chapter-pane'</span>);
      self.$slideContainer      = self.$el.find(<span class="string">'.editorial-carousel'</span>);
      self.$thumbNav            = self.$el.find(<span class="string">'.thumb-nav'</span>);
      self.$slider              = self.$el.find(<span class="string">'.slider'</span>);
      self.$leftShade           = self.$el.find(<span class="string">'.left-shade'</span>);
      self.$rightShade          = self.$el.find(<span class="string">'.right-shade'</span>);
      self.$thumbItems          = self.$thumbNav.find(<span class="string">'li'</span>);
      self.$thumbLabels         = self.$thumbNav.find(<span class="string">'span'</span>);
      self.$slideInner          = self.$slides.find(<span class="string">'.editorial'</span>);
      self.$mediaChapter        = self.$el.closest(<span class="string">'.editorial'</span>);
      self.isMediaChapter       = self.$mediaChapter.hasClass(<span class="string">'mediaright'</span>) || self.$mediaChapter.hasClass(<span class="string">'medialeft'</span>);

      self.hasThumbs            = self.$thumbNav.length &gt; <span class="number">0</span>;
      self.numSlides            = self.$slides.length;
      self.moduleId             = self.$el.attr(<span class="string">'id'</span>);
      self.transitonDelay       = <span class="number">5000</span>,
      self.currentId            = <span class="literal">undefined</span>;

</pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>to keep track of slide indexes</p>             </td>             <td class="code">               <div class="highlight"><pre>      self.prevIndex            = <span class="number">0</span>;
      self.currIndex            = <span class="number">0</span>;

</pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>touch defaults</p>             </td>             <td class="code">               <div class="highlight"><pre>      self.startInteractionPointX = <span class="literal">null</span>;
      self.lastTouch            = <span class="literal">null</span>;
      self.handleStartPosition  = <span class="literal">null</span>;

</pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>deep linking vars</p>             </td>             <td class="code">               <div class="highlight"><pre>      self.location             = window.location;
      self.history              = window.history;
      self.initFromhash         = <span class="literal">false</span>;
      self.currentHash          = <span class="literal">null</span>;

      self.isDesktop = <span class="literal">false</span>;
      self.isMobile = <span class="literal">false</span>;

</pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>Inits the module</p>             </td>             <td class="code">               <div class="highlight"><pre>      self.init();
    };

    EditorialChapters.prototype = {
      constructor: EditorialChapters,

</pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>Initalize the module</p>             </td>             <td class="code">               <div class="highlight"><pre>      init : <span class="keyword">function</span>( param ) {
        <span class="keyword">var</span> self = <span class="keyword">this</span>;

        $(domReady);

        <span class="function"><span class="keyword">function</span> <span class="title">domReady</span><span class="params">()</span>{</span>

          self.setupEvents();

          self.setupSlides();

          self.setupCarousel();

          self.setupBreakpoints();

          <span class="keyword">if</span>(self.hasThumbs){ self.createThumbNav(); }

          self.$slideContainer.fadeTo(<span class="number">0</span>,<span class="number">1</span>);

</pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>initialize the router for deep linking</p>             </td>             <td class="code">               <div class="highlight"><pre>          Router.on(<span class="string">'chapter-'</span>+self.moduleId+<span class="string">'(/:a)'</span>, $.proxy(self.directFromHash, self));

          self.$thumbNav.on(self.downEvent, <span class="keyword">function</span>(e) { self.dragStart(e); });
        }
      },

      setupBreakpoints: <span class="keyword">function</span>() {
        <span class="keyword">var</span> self = <span class="keyword">this</span>;

</pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>add enquire due to functionality difference with mobile => desktop</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="keyword">if</span> ( Modernizr.mediaqueries ) {
          enquire
          .register(<span class="string">'(min-width: 48em)'</span>, {
            match: <span class="keyword">function</span>() {
              self.setupMobilePlus();
            }
          })
          .register(<span class="string">'(max-width: 47.9375em)'</span>, {
            match: <span class="keyword">function</span>() {
              self.setupMobile();
            }
          });
        } <span class="comment">// end if(Modernizr.mediaqueries )</span>
      },

</pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>Sets up slides to correct width based on how many there are</p>             </td>             <td class="code">               <div class="highlight"><pre>      setupSlides: <span class="keyword">function</span>(){
        <span class="keyword">var</span> self = <span class="keyword">this</span>;

        self.$slideContainer.width( <span class="number">100</span> * (self.numSlides + <span class="number">2</span>)+ <span class="string">'%'</span> );
        self.$slides.width( <span class="number">100</span> / (self.numSlides + <span class="number">2</span>) + <span class="string">'%'</span> );
      },

</pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>Setup touch event types</p>             </td>             <td class="code">               <div class="highlight"><pre>      setupEvents: <span class="keyword">function</span>(){
        <span class="keyword">var</span> self = <span class="keyword">this</span>;

        <span class="keyword">if</span> (Modernizr.touch) {
          self.hasTouch         = <span class="literal">true</span>;
          self.downEvent        = <span class="string">'touchstart.rp'</span>;
          self.moveEvent        = <span class="string">'touchmove.rp'</span>;
          self.upEvent          = <span class="string">'touchend.pdpss'</span>;
          self.cancelEvent      = <span class="string">'touchcancel.rp'</span>;
          self.lastItemFriction = <span class="number">0.5</span>;
        } <span class="keyword">else</span> {
          self.hasTouch = <span class="literal">false</span>;
          self.lastItemFriction = <span class="number">0.2</span>;
          self.downEvent   = <span class="string">'mousedown.rp'</span>;
          self.moveEvent   = <span class="string">'mousemove.rp'</span>;
          self.upEvent     = <span class="string">'mouseup.rp'</span>;
          self.cancelEvent = <span class="string">'mouseup.rp'</span>;
          self.clickEvent = <span class="string">'click.pdpss'</span>;
        }

        self.tapOrClick = <span class="keyword">function</span>(){
          <span class="keyword">return</span> self.hasTouch ? self.upEvent : self.clickEvent;
        };
      },

      setupMobilePlus: <span class="keyword">function</span>() {
        <span class="keyword">var</span> self = <span class="keyword">this</span>;


        self.isMobile = <span class="literal">false</span>;
        self.isDesktop = <span class="literal">true</span>;

        self.$window.off(<span class="string">'resize.e5-mobile-resize'</span>);
        self.removeWrapperStyles();
        self.$win.trigger(<span class="string">'resize'</span>);
      },

      setupMobile: <span class="keyword">function</span>() {
        <span class="keyword">var</span> self = <span class="keyword">this</span>;

        self.isMobile = <span class="literal">true</span>;
        self.isDesktop = <span class="literal">false</span>;

        self.$window.on(<span class="string">'resize.e5-mobile-resize'</span>, $.proxy(self.getSlideHeight, self ));

        Settings.editorialModuleInitialzied.then(<span class="keyword">function</span>(){

</pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>even with a deffered object window.load does not fire with require.js
the deffered object is firing before the dom has fully loaded. The perfect
approach would be to run on window.load and get the height of the individual
slides, however that isnt an option. So were back to an arbitary settimout.</p>             </td>             <td class="code">               <div class="highlight"><pre>          setTimeout( <span class="keyword">function</span>() {
            self.getSlideHeight();
            self.getSliderWidth();
          }, <span class="number">500</span>);

          <span class="keyword">if</span> (self.$el.hasClass(<span class="string">'text-mode'</span>)) {
            self.initScroller();
</pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p>show slider shades if needed</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="keyword">var</span> node = self.$slider.get(<span class="number">0</span>),
                curTransform = <span class="keyword">new</span> WebKitCSSMatrix(window.getComputedStyle(node).webkitTransform),
                sliderOffset = node.offsetLeft + curTransform.m41, <span class="comment">//real offset left</span>
                sliderWidth = self.$slider.width(),
                navWidth = self.$thumbNav.width();
            (sliderOffset &lt; <span class="number">0</span>) ? self.$leftShade.show() : self.$leftShade.hide();
            (sliderOffset &gt; ((-<span class="number">1</span> * sliderWidth) + navWidth)) ? self.$rightShade.show() : self.$rightShade.hide();
          }
        });
      },

      dragStart: <span class="keyword">function</span>(e) {
        <span class="keyword">var</span> self = <span class="keyword">this</span>,
            point;

        <span class="keyword">if</span> (self.hasTouch) {
          <span class="keyword">var</span> touches = e.originalEvent.touches;
          <span class="keyword">if</span> (touches &amp;&amp; touches.length &gt; <span class="number">0</span>) {
            point = touches[<span class="number">0</span>];
            <span class="keyword">if</span> (touches.length &gt; <span class="number">1</span>) {
              self.multipleTouches = <span class="literal">true</span>;
            }
          } <span class="keyword">else</span> {
            <span class="keyword">return</span>;
          }
        } <span class="keyword">else</span> {
          point = e;
          e.preventDefault();

          <span class="keyword">if</span> (e.which !== <span class="number">1</span>) {
            <span class="keyword">return</span>;
          }
        }

</pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>reset the distance moved since its a new start</p>             </td>             <td class="code">               <div class="highlight"><pre>        self.distanceMoved = <span class="literal">null</span>;
        self.handleStartPosition = self.getPagePosition(e);
        self.startInteractionPointX = point.pageX;

        self.$doc.on(self.moveEvent , $.proxy(self.dragMove , self)).on(self.upEvent , $.proxy(self.dragEnd, self));

      },

      dragMove: <span class="keyword">function</span>(e) {
        <span class="keyword">var</span> self = <span class="keyword">this</span>,
            distX = self.getPagePosition(e).x - self.handleStartPosition.x,
            distY = self.getPagePosition(e).y - self.handleStartPosition.y,
            point,
            distanceMoved;

</pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <p>some really gross logic</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="keyword">if</span> (self.hasTouch) {
          <span class="keyword">if</span> (self.lockAxis) {
            <span class="keyword">return</span>;
          }
          <span class="keyword">var</span> touches = e.originalEvent.touches;
          <span class="keyword">if</span> (touches) {
            <span class="keyword">if</span> (touches.length &gt; <span class="number">1</span>) {
              <span class="keyword">return</span>;
            } <span class="keyword">else</span> {
              point = touches[<span class="number">0</span>];
            }
          } <span class="keyword">else</span> {
            <span class="keyword">return</span>;
          }
        } <span class="keyword">else</span> {
          point = e;
        }

        self.distanceMoved = Math.abs(point.pageX - self.startInteractionPointX);
      },

      dragEnd: <span class="keyword">function</span>(e) {
        <span class="keyword">var</span> self = <span class="keyword">this</span>;

</pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <p>stop listening on the document for movement</p>             </td>             <td class="code">               <div class="highlight"><pre>        self.$doc.off(self.moveEvent).off(self.upEvent);
      },

      getPagePosition: <span class="keyword">function</span>(e) {

        <span class="keyword">var</span> self = <span class="keyword">this</span>;

        <span class="keyword">if</span> ( !e.pageX &amp;&amp; !e.originalEvent ) {
          <span class="keyword">return</span>;
        }

        self.lastTouch = self.lastTouch || {};

</pre></div>             </td>           </tr>                               <tr id="section-22">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-22">&#182;</a>               </div>               <p>Cache position for touchmove/touchstart, as touchend doesn't provide it.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="keyword">if</span> ( e.type === <span class="string">'touchmove'</span> || e.type === <span class="string">'touchstart'</span> ) {
          self.lastTouch = e.originalEvent.touches[<span class="number">0</span>];
        }

        <span class="keyword">return</span> {
          <span class="string">'x'</span>: (e.pageX || self.lastTouch.pageX),
          <span class="string">'y'</span>: (e.pageY || self.lastTouch.pageY)
        };
      },

      removeWrapperStyles: <span class="keyword">function</span>() {
        <span class="keyword">var</span> self = <span class="keyword">this</span>;

        self.$slider.removeAttr(<span class="string">'style'</span>);
        self.$slideWrapper.removeAttr(<span class="string">'style'</span>);

      },

</pre></div>             </td>           </tr>                               <tr id="section-23">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-23">&#182;</a>               </div>               <p>Main setup method for the carousel</p>             </td>             <td class="code">               <div class="highlight"><pre>      setupCarousel: <span class="keyword">function</span>(){

        <span class="keyword">var</span> self = <span class="keyword">this</span>,
            currIndx,
            $currSlide,
            $currSlideImg,
            $nextSlideImg;

        currIndx = <span class="number">0</span>;
        $currSlide = self.$slides.eq(currIndx);
        $currSlideImg = $currSlide.find(<span class="string">'.image-module'</span>);
        $nextSlideImg = (currIndx + <span class="number">1</span>) &gt;= self.$slides.length ? self.$slides.eq(<span class="number">0</span>).find(<span class="string">'.image-module'</span>) : self.$slides.eq(currIndx + <span class="number">1</span>).find(<span class="string">'.image-module'</span>);

</pre></div>             </td>           </tr>                               <tr id="section-24">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-24">&#182;</a>               </div>               <p>Using Sony Carousel for this module</p>             </td>             <td class="code">               <div class="highlight"><pre>        self.$slideContainer.sonyCarouselFade({
          wrapper: <span class="string">'.editorial-carousel-wrapper.chapter-pane'</span>,
          slides: <span class="string">'.editorial-carousel-slide.chapter-slide'</span>,
          looped: <span class="literal">false</span>,
          jumping: <span class="literal">false</span>,
          axis: <span class="string">'x'</span>,
          useCSS3: self.useCSS3,
          paddles: <span class="literal">false</span>,
          pagination: <span class="literal">false</span>,
          draggable: <span class="literal">false</span>
        });

        self.$slideContainer.eq(<span class="number">0</span>).on(<span class="string">'SonyCarouselFade:gotoSlide'</span> , $.proxy( self.onSlideUpdate , self ) );

</pre></div>             </td>           </tr>                               <tr id="section-25">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-25">&#182;</a>               </div>               <p>we need to solve an issue of all images being loaded on DomReady</p>             </td>             <td class="code">               <div class="highlight"><pre>        self.setCurrentActiveThumb();
        $currSlideImg.addClass(<span class="string">'unhide'</span>);
        $nextSlideImg.addClass(<span class="string">'unhide'</span>);


        iQ.update();
      },

      getSliderWidth: <span class="keyword">function</span>() {
        <span class="keyword">var</span> self = <span class="keyword">this</span>,
            $currTabs,
            sliderWidth,
            minSliderWidth;

        $currTabs = self.$slider.find(<span class="string">'li'</span>);
        sliderWidth = <span class="number">5</span>; <span class="comment">// adding 5 just to be prepared for bleed</span>
        minSliderWidth = <span class="number">100</span>; <span class="comment">// no slider should ever be smaller than this</span>

        $currTabs.each(<span class="keyword">function</span>(){
          <span class="keyword">var</span> $el = $(<span class="keyword">this</span>);
          sliderWidth = (sliderWidth + $el.outerWidth());
        });

</pre></div>             </td>           </tr>                               <tr id="section-26">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-26">&#182;</a>               </div>               <p>only if we have a slider width do we want to apply it</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="keyword">if</span> (sliderWidth &gt;= minSliderWidth) { self.$slider.width(sliderWidth); }
      },

</pre></div>             </td>           </tr>                               <tr id="section-27">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-27">&#182;</a>               </div>               <p>if its on a mobile device per slide change we need to
get the height of the container to the height of the
active slide.</p>             </td>             <td class="code">               <div class="highlight"><pre>      getSlideHeight: <span class="keyword">function</span>() {
        <span class="keyword">var</span> self = <span class="keyword">this</span>,
            $currSlides,
            groups;

        $currSlides = self.$slides.find(<span class="string">'.inner'</span>);

        groups = [$currSlides];
        $.evenHeights(groups);
      },

</pre></div>             </td>           </tr>                               <tr id="section-28">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-28">&#182;</a>               </div>               <p>Listens for slide changes and updates the correct thumbnail</p>             </td>             <td class="code">               <div class="highlight"><pre>      onSlideUpdate: <span class="keyword">function</span>(e , currIndx){
        
        <span class="keyword">var</span> self = <span class="keyword">this</span>,
            $currSlide,
            $prevSlide,
            $currSlideImg,
            $nextSlideImg;

        self.currentId = currIndx;

        $currSlide = self.$slides.eq(currIndx);
        $currSlideImg = $currSlide.find(<span class="string">'.image-module'</span>);
        $nextSlideImg = (currIndx + <span class="number">1</span>) &gt;= self.$slides.length ? self.$slides.eq(<span class="number">0</span>).find(<span class="string">'.image-module'</span>) : self.$slides.eq(currIndx + <span class="number">1</span>).find(<span class="string">'.image-module'</span>);

</pre></div>             </td>           </tr>                               <tr id="section-29">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-29">&#182;</a>               </div>               <p>we need to solve an issue of all images being loaded on DomReady</p>             </td>             <td class="code">               <div class="highlight"><pre>        self.setCurrentActiveThumb();
        $currSlideImg.addClass(<span class="string">'unhide'</span>);
        $nextSlideImg.addClass(<span class="string">'unhide'</span>);

        <span class="keyword">if</span> (!self.isMediaChapter) {
          $currSlide.addClass(<span class="string">'pos-active'</span>).removeClass(<span class="string">'off-screen'</span>); 

          setTimeout(<span class="keyword">function</span>(){
            $currSlide.siblings().removeClass(<span class="string">'pos-active'</span>).addClass(<span class="string">'off-screen'</span>);
            <span class="keyword">if</span>(!$currSlide.hasClass(<span class="string">'pos-active'</span>)){ 
              $currSlide.addClass(<span class="string">'pos-active'</span>).removeClass(<span class="string">'off-screen'</span>); 
            }
          }, <span class="number">500</span>);
        } <span class="keyword">else</span> {
          $currSlide.addClass(<span class="string">'pos-active'</span>);
          $currSlide.siblings().removeClass(<span class="string">'pos-active'</span>);
        }

        self.$window.trigger(<span class="string">'e5-slide-change'</span>);
        iQ.update();
      },

</pre></div>             </td>           </tr>                               <tr id="section-30">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-30">&#182;</a>               </div>               <p>Bind events to the thumbnail navigation</p>             </td>             <td class="code">               <div class="highlight"><pre>      createThumbNav: <span class="keyword">function</span>(){
        <span class="keyword">var</span> self = <span class="keyword">this</span>,
        $anchors = self.$thumbNav.find(<span class="string">'li'</span>);

        $anchors.on( self.tapOrClick() , <span class="keyword">function</span>(e){
          <span class="keyword">if</span> (self.distanceMoved &gt;= <span class="number">25</span>) { <span class="keyword">return</span>; }
          e.preventDefault();
          self.onThumbSelected($(<span class="keyword">this</span>));
        });

        $anchors.eq(<span class="number">0</span>).addClass(<span class="string">'active'</span>);

      },

</pre></div>             </td>           </tr>                               <tr id="section-31">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-31">&#182;</a>               </div>               <p>Handles when a thumbnail is chosen</p>             </td>             <td class="code">               <div class="highlight"><pre>      onThumbSelected: <span class="keyword">function</span>($el){
        <span class="keyword">var</span> self = <span class="keyword">this</span>,
        selectedIndex =  $el.index(),
        $anchors = self.$thumbNav.find(<span class="string">'li'</span>).not(<span class="string">':eq('</span> + selectedIndex + <span class="string">')'</span>),
        animDirection = <span class="string">''</span>;

        self.currentId = selectedIndex;

</pre></div>             </td>           </tr>                               <tr id="section-32">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-32">&#182;</a>               </div>               <p>need to set a tmeout of 100ms so we can
fix a flicker bug on mobile devices</p>             </td>             <td class="code">               <div class="highlight"><pre>        $el.addClass(<span class="string">'active'</span>);

        setTimeout(<span class="keyword">function</span>(){
          $anchors.removeClass(<span class="string">'active'</span>);
        },<span class="number">100</span>);

        self.$slideContainer.sonyCarouselFade( <span class="string">'gotoSlide'</span> , self.currentId );
      },

</pre></div>             </td>           </tr>                               <tr id="section-33">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-33">&#182;</a>               </div>               <p>Runs when a tab is updated and changes the hash</p>             </td>             <td class="code">               <div class="highlight"><pre>      updateHash: <span class="keyword">function</span>(location, currentId) {
        <span class="keyword">var</span> self = <span class="keyword">this</span>,
            href,
            fragment;

</pre></div>             </td>           </tr>                               <tr id="section-34">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-34">&#182;</a>               </div>               <p>if we don't have a module id we dont want to continue
0 shows up as false</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="keyword">if</span> (!self.moduleId || currentId === <span class="literal">null</span> || currentId === <span class="literal">undefined</span>) { <span class="keyword">return</span>; }

        href = location.href.replace(<span class="regexp">/(javascript:|#).*$/</span>, <span class="string">''</span>);
        fragment = <span class="string">'chapter-'</span> + self.moduleId + <span class="string">'/'</span> + currentId;
        self.currentHash = fragment;

        location.replace(href + <span class="string">'#'</span> + fragment);
      },

</pre></div>             </td>           </tr>                               <tr id="section-35">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-35">&#182;</a>               </div>               <p>Runs when a hash change is detected and will direct users to the proper tab</p>             </td>             <td class="code">               <div class="highlight"><pre>      directFromHash: <span class="keyword">function</span>() {
        <span class="keyword">var</span> self = <span class="keyword">this</span>,
            hash,
            chapterId,
            $chapterTabs,
            $chapterEl;

</pre></div>             </td>           </tr>                               <tr id="section-36">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-36">&#182;</a>               </div>               <p>if we have already initialized from hash return</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="keyword">if</span> (self.initFromhash) { <span class="keyword">return</span>; }

        self.currentHash = Router.getHash();
        chapterId = self.currentHash.replace(<span class="regexp">/.*?(\d+)[^\d]*$/</span>,<span class="string">'$1'</span>);
        $chapterTabs = self.$thumbNav.find(<span class="string">'li'</span>);

</pre></div>             </td>           </tr>                               <tr id="section-37">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-37">&#182;</a>               </div>               <p>we should never run the method again unless script inits again</p>             </td>             <td class="code">               <div class="highlight"><pre>        self.initFromhash = <span class="literal">true</span>;

</pre></div>             </td>           </tr>                               <tr id="section-38">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-38">&#182;</a>               </div>               <p>only if the chapter id is less than the length of actual tabs
i.e <code>chapter-100</code> will probably not exist</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="keyword">if</span> (chapterId &lt; $chapterTabs.length) {
          $chapterEl = $chapterTabs.eq(chapterId);
          self.onThumbSelected($chapterEl);
        }
      },

</pre></div>             </td>           </tr>                               <tr id="section-39">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-39">&#182;</a>               </div>               <p>Sets the current active thumbnail</p>             </td>             <td class="code">               <div class="highlight"><pre>      setCurrentActiveThumb: <span class="keyword">function</span>(){
        <span class="keyword">var</span> self = <span class="keyword">this</span>,
            tabId = self.currentId ? self.currentId : <span class="number">0</span>,
            $chapterTabs,
            $currTab;

        $chapterTabs = self.$thumbNav.find(<span class="string">'li'</span>).not(<span class="string">':eq('</span> + tabId + <span class="string">')'</span>);
        $currTab = self.$thumbNav.find(<span class="string">'li'</span>).eq( tabId );

</pre></div>             </td>           </tr>                               <tr id="section-40">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-40">&#182;</a>               </div>               <p>need to set a tmeout of 100ms so we can
fix a flicker bug on mobile devices</p>             </td>             <td class="code">               <div class="highlight"><pre>        $currTab.addClass(<span class="string">'active'</span>);
        setTimeout(<span class="keyword">function</span>(){
          <span class="keyword">var</span> _<span class="keyword">this</span> = self;
          $chapterTabs.removeClass(<span class="string">'active'</span>);
          !$currTab.hasClass(<span class="string">'active'</span>) ? $currTab.addClass(<span class="string">'active'</span>) : <span class="string">''</span>;
        },<span class="number">100</span>);

        self.updateHash(self.location, self.currentId);
      },

      initScroller: <span class="keyword">function</span>(){
        <span class="keyword">var</span> self = <span class="keyword">this</span>;

        self.$thumbNav.scrollerModule({
          contentSelector: <span class="string">'.slider'</span>,
          iscrollProps: {
            hScrollbar: <span class="literal">false</span>,
            vScrollbar: <span class="literal">false</span>,
            isOverflowHidden: <span class="literal">false</span>,
</pre></div>             </td>           </tr>                               <tr id="section-41">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-41">&#182;</a>               </div>               <p>increase width of slider by 1 on load so scrolled items dont wrap in FF</p>             </td>             <td class="code">               <div class="highlight"><pre>            onRefresh: <span class="keyword">function</span>(){
              self.$slider.width( self.$slider.width() + <span class="number">5</span> );
            },
            onScrollMove: <span class="keyword">function</span>(){
              <span class="keyword">var</span> node = self.$slider.get(<span class="number">0</span>),
                  curTransform = <span class="keyword">new</span> WebKitCSSMatrix(window.getComputedStyle(node).webkitTransform),
                  sliderOffset = node.offsetLeft + curTransform.m41, <span class="comment">//real offset left</span>
                  sliderWidth = self.$slider.width(),
                  navWidth = self.$thumbNav.width();

</pre></div>             </td>           </tr>                               <tr id="section-42">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-42">&#182;</a>               </div>               <p>left shadow</p>             </td>             <td class="code">               <div class="highlight"><pre>              <span class="keyword">if</span> (sliderOffset &lt; <span class="number">0</span>) {
                self.$leftShade.show();
              } <span class="keyword">else</span> {
                self.$leftShade.hide();
              }

</pre></div>             </td>           </tr>                               <tr id="section-43">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-43">&#182;</a>               </div>               <p>right shadhow</p>             </td>             <td class="code">               <div class="highlight"><pre>              <span class="keyword">if</span> ( sliderOffset &gt; ((-<span class="number">1</span> * sliderWidth) + navWidth)) {
                self.$rightShade.show();
              } <span class="keyword">else</span> {
                self.$rightShade.hide();
              }
            }
          }
        });
      }

</pre></div>             </td>           </tr>                               <tr id="section-44">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-44">&#182;</a>               </div>               <p>end prototype object</p>             </td>             <td class="code">               <div class="highlight"><pre>    };

</pre></div>             </td>           </tr>                               <tr id="section-45">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-45">&#182;</a>               </div>               <p>jQuery Plugin Definition</p>             </td>             <td class="code">               <div class="highlight"><pre>    $.fn.editorialChapters = <span class="keyword">function</span>( options ) {
      <span class="keyword">var</span> args = Array.prototype.slice.call( arguments, <span class="number">1</span> );
      <span class="keyword">return</span> <span class="keyword">this</span>.each(<span class="keyword">function</span>() {
        <span class="keyword">var</span> self = $( <span class="keyword">this</span> ),
          editorialChapters = self.data( <span class="string">'editorialChapters'</span> );

</pre></div>             </td>           </tr>                               <tr id="section-46">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-46">&#182;</a>               </div>               <p>If we don't have a stored moduleName, make a new one and save it.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="keyword">if</span> ( !editorialChapters ) {
            editorialChapters = <span class="keyword">new</span> EditorialChapters( self, options );
            self.data( <span class="string">'moduleName'</span>, editorialChapters );
        }

        <span class="keyword">if</span> ( <span class="keyword">typeof</span> options === <span class="string">'string'</span> ) {
          editorialChapters[ options ].apply( editorialChapters, args );
        }
      });
    };

</pre></div>             </td>           </tr>                               <tr id="section-47">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-47">&#182;</a>               </div>               <h2>Defaults</h2>             </td>             <td class="code">               <div class="highlight"><pre>    $.fn.editorialChapters.defaults = {};

</pre></div>             </td>           </tr>                               <tr id="section-48">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-48">&#182;</a>               </div>               <h2>Non override-able settings</h2>             </td>             <td class="code">               <div class="highlight"><pre>    $.fn.editorialChapters.settings = {};

    <span class="keyword">return</span> self;
 });



</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 