<!DOCTYPE html>  <html> <head>   <title>jquery.imagesloaded.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="brightcove-builder.html">                 brightcove-builder.js               </a>                                           <a class="source" href="editorial-dual-viewer-e9.html">                 editorial-dual-viewer-e9.js               </a>                                           <a class="source" href="form-actions.html">                 form-actions.js               </a>                                           <a class="source" href="hotspot_explorer.html">                 hotspot_explorer.js               </a>                                           <a class="source" href="jquery.viewport.html">                 jquery.viewport.js               </a>                                           <a class="source" href="primary-tout-p1-d7.html">                 primary-tout-p1-d7.js               </a>                                           <a class="source" href="related-products.html">                 related-products.js               </a>                                           <a class="source" href="sony-gallery.html">                 sony-gallery.js               </a>                                           <a class="source" href="sony-one-carousel.html">                 sony-one-carousel.js               </a>                                           <a class="source" href="sony-sequencer.html">                 sony-sequencer.js               </a>                                           <a class="source" href="spec-multi-z2.html">                 spec-multi-z2.js               </a>                                           <a class="source" href="spec-single-z1.html">                 spec-single-z1.js               </a>                                           <a class="source" href="tertiary-t1-t5-module.html">                 tertiary-t1-t5-module.js               </a>                                           <a class="source" href="ux-marketing-convergence-e14.html">                 ux-marketing-convergence-e14.js               </a>                                           <a class="source" href="enquire.html">                 enquire.js               </a>                                           <a class="source" href="jquery.imagesloaded.html">                 jquery.imagesloaded.js               </a>                                           <a class="source" href="jquery.infinitescroll.html">                 jquery.infinitescroll.js               </a>                                           <a class="source" href="jquery.throttle-debounce.html">                 jquery.throttle-debounce.js               </a>                                           <a class="source" href="debug_toggle.html">                 debug_toggle.js               </a>                                           <a class="source" href="exports.html">                 exports.js               </a>                                           <a class="source" href="global-init.html">                 global-init.js               </a>                                           <a class="source" href="global-nav.html">                 global-nav.js               </a>                                           <a class="source" href="global-tracking.html">                 global-tracking.js               </a>                                           <a class="source" href="iq.html">                 iq.js               </a>                                           <a class="source" href="sony-iscroll.html">                 sony-iscroll.js               </a>                                           <a class="source" href="jodo.rangecontrol.1.4.html">                 jodo.rangecontrol.1.4.js               </a>                                           <a class="source" href="jquery.shuffle.html">                 jquery.shuffle.js               </a>                                           <a class="source" href="jquery.simpleknob.html">                 jquery.simpleknob.js               </a>                                           <a class="source" href="jquery.simplescroll.html">                 jquery.simplescroll.js               </a>                                           <a class="source" href="sony-draggable.html">                 sony-draggable.js               </a>                                           <a class="source" href="sony-evenheights.html">                 sony-evenheights.js               </a>                                           <a class="source" href="sony-scroller.html">                 sony-scroller.js               </a>                                           <a class="source" href="sony-stickytabs.html">                 sony-stickytabs.js               </a>                                           <a class="source" href="sony-tab.html">                 sony-tab.js               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               jquery.imagesloaded.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre><span class="comment">/*!
 * jQuery imagesLoaded plugin v2.1.1
 * http://github.com/desandro/imagesloaded
 *
 * MIT License. by Paul Irish et al.
 */</span>

<span class="comment">/*jshint curly: true, eqeqeq: true, noempty: true, strict: true, undef: true, browser: true */</span>
<span class="comment">/*global jQuery: false */</span>

;(<span class="keyword">function</span>($, <span class="literal">undefined</span>) {
<span class="string">'use strict'</span>;

</pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>blank image data-uri bypasses webkit log warning (thx doug jones)</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="keyword">var</span> BLANK = <span class="string">'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw=='</span>;

$.fn.imagesLoaded = <span class="keyword">function</span>( callback ) {
	<span class="keyword">var</span> $<span class="keyword">this</span> = <span class="keyword">this</span>,
		deferred = $.isFunction($.Deferred) ? $.Deferred() : <span class="number">0</span>,
		hasNotify = $.isFunction(deferred.notify),
		$images = $<span class="keyword">this</span>.find(<span class="string">'img'</span>).add( $<span class="keyword">this</span>.filter(<span class="string">'img'</span>) ),
		loaded = [],
		proper = [],
		broken = [];

</pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>Register deferred callbacks</p>             </td>             <td class="code">               <div class="highlight"><pre>	<span class="keyword">if</span> ($.isPlainObject(callback)) {
		$.each(callback, <span class="function"><span class="keyword">function</span> <span class="params">(key, value)</span> {</span>
			<span class="keyword">if</span> (key === <span class="string">'callback'</span>) {
				callback = value;
			} <span class="keyword">else</span> <span class="keyword">if</span> (deferred) {
				deferred[key](value);
			}
		});
	}

	<span class="function"><span class="keyword">function</span> <span class="title">doneLoading</span><span class="params">()</span> {</span>
		<span class="keyword">var</span> $proper = $(proper),
			$broken = $(broken);

		<span class="keyword">if</span> ( deferred ) {
			<span class="keyword">if</span> ( broken.length ) {
				deferred.reject( $images, $proper, $broken );
			} <span class="keyword">else</span> {
				deferred.resolve( $images );
			}
		}

		<span class="keyword">if</span> ( $.isFunction( callback ) ) {
			callback.call( $<span class="keyword">this</span>, $images, $proper, $broken );
		}
	}

	<span class="function"><span class="keyword">function</span> <span class="title">imgLoadedHandler</span><span class="params">( event )</span> {</span>
		imgLoaded( event.target, event.type === <span class="string">'error'</span> );
	}

	<span class="function"><span class="keyword">function</span> <span class="title">imgLoaded</span><span class="params">( img, isBroken )</span> {</span>
</pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>don't proceed if BLANK image, or image is already loaded</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="keyword">if</span> ( img.src === BLANK || $.inArray( img, loaded ) !== -<span class="number">1</span> ) {
			<span class="keyword">return</span>;
		}

</pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>store element in loaded images array</p>             </td>             <td class="code">               <div class="highlight"><pre>		loaded.push( img );

</pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>keep track of broken and properly loaded images</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="keyword">if</span> ( isBroken ) {
			broken.push( img );
		} <span class="keyword">else</span> {
			proper.push( img );
		}

</pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>cache image and its state for future calls</p>             </td>             <td class="code">               <div class="highlight"><pre>		$.data( img, <span class="string">'imagesLoaded'</span>, { isBroken: isBroken, src: img.src } );

</pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>trigger deferred progress method if present</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="keyword">if</span> ( hasNotify ) {
			deferred.notifyWith( $(img), [ isBroken, $images, $(proper), $(broken) ] );
		}

</pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>call doneLoading and clean listeners if all images are loaded</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="keyword">if</span> ( $images.length === loaded.length ) {
			setTimeout( doneLoading );
			$images.unbind( <span class="string">'.imagesLoaded'</span>, imgLoadedHandler );
		}
	}

</pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>if no images, trigger immediately</p>             </td>             <td class="code">               <div class="highlight"><pre>	<span class="keyword">if</span> ( !$images.length ) {
		doneLoading();
	} <span class="keyword">else</span> {
		$images.bind( <span class="string">'load.imagesLoaded error.imagesLoaded'</span>, imgLoadedHandler )
		.each( <span class="keyword">function</span>( i, el ) {
			<span class="keyword">var</span> src = el.src;

</pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>find out if this image has been already checked for status
if it was, and src has not changed, call imgLoaded on it</p>             </td>             <td class="code">               <div class="highlight"><pre>			<span class="keyword">var</span> cached = $.data( el, <span class="string">'imagesLoaded'</span> );
			<span class="keyword">if</span> ( cached &amp;&amp; cached.src === src ) {
				imgLoaded( el, cached.isBroken );
				<span class="keyword">return</span>;
			}

</pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>if complete is true and browser supports natural sizes, try
to check for image status manually</p>             </td>             <td class="code">               <div class="highlight"><pre>			<span class="keyword">if</span> ( el.complete &amp;&amp; el.naturalWidth !== <span class="literal">undefined</span> ) {
				imgLoaded( el, el.naturalWidth === <span class="number">0</span> || el.naturalHeight === <span class="number">0</span> );
				<span class="keyword">return</span>;
			}

</pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>cached images don't fire load sometimes, so we reset src, but only when
dealing with IE, or image is complete (loaded) and failed manual check
webkit hack from http://groups.google.com/group/jquery-dev/browse_thread/thread/eee6ab7b2da50e1f</p>             </td>             <td class="code">               <div class="highlight"><pre>			<span class="keyword">if</span> ( el.readyState || el.complete ) {
				el.src = BLANK;
				el.src = src;
			}
		});
	}

	<span class="keyword">return</span> deferred ? deferred.promise( $<span class="keyword">this</span> ) : $<span class="keyword">this</span>;
};

})(jQuery);
</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 