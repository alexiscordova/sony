<!DOCTYPE html>  <html> <head>   <title>jquery.simpleknob.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="debug_toggle.html">                 debug_toggle.js               </a>                                           <a class="source" href="form-actions.html">                 form-actions.js               </a>                                           <a class="source" href="index.html">                 index.js               </a>                                           <a class="source" href="jodo.rangecontrol.1.4.html">                 jodo.rangecontrol.1.4.js               </a>                                           <a class="source" href="jquery.shuffle.html">                 jquery.shuffle.js               </a>                                           <a class="source" href="jquery.simpleknob.html">                 jquery.simpleknob.js               </a>                                           <a class="source" href="jquery.simplescroll.html">                 jquery.simplescroll.js               </a>                                           <a class="source" href="jquery.viewport.html">                 jquery.viewport.js               </a>                                           <a class="source" href="sony-carousel.html">                 sony-carousel.js               </a>                                           <a class="source" href="sony-draggable.html">                 sony-draggable.js               </a>                                           <a class="source" href="sony-evenheights.html">                 sony-evenheights.js               </a>                                           <a class="source" href="sony-navigationdots.html">                 sony-navigationdots.js               </a>                                           <a class="source" href="sony-paddles.html">                 sony-paddles.js               </a>                                           <a class="source" href="sony-scroller.html">                 sony-scroller.js               </a>                                           <a class="source" href="sony-sequencer.html">                 sony-sequencer.js               </a>                                           <a class="source" href="sony-stickynav.html">                 sony-stickynav.js               </a>                                           <a class="source" href="sony-stickytabs.html">                 sony-stickytabs.js               </a>                                           <a class="source" href="sony-tab.html">                 sony-tab.js               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               jquery.simpleknob.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre>
</pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <h2>jQuery SimpleKnob</h2>

<ul>
<li><strong>Class:</strong> SimpleKnob</li>
<li><strong>Version:</strong> 0.1</li>
<li><strong>Adapted by:</strong> George Pantazis</li>
<li><strong>Modified:</strong> 01/30/2013</li>
<li><strong>Dependencies:</strong> Tested with jQuery 1.9</li>
</ul>

<p><em>Notes:</em>
This is a simplified version of jQuery Knob, by Anthony Terrien.
Licensing and other notes on the original source, located
<a href="https://raw.github.com/aterrien/jQuery-Knob/master/js/jquery.knob.js">here</a>.</p>

<p>This version minconcats to about 5KB, a 40% savings over the original version,
mostly from removing touch interactions / bindings and other options.
Refer to the options block below for available configurations.</p>

<p><em>Example usage:</em></p>

<pre><code>$("#foo").simpleKnob({
  'fgColor': '#000',
  'width': 100,
  'height': 100
});
</code></pre>             </td>             <td class="code">               <div class="highlight"><pre>
define(<span class="keyword">function</span>(require){

  <span class="string">'use strict'</span>;

  <span class="keyword">var</span> $ = require(<span class="string">'jquery'</span>);

  <span class="keyword">var</span> k = {},
    max = Math.max,
    min = Math.min;

  k.c = {};
  k.c.d = $(document);

  k.o = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
    <span class="keyword">var</span> s = <span class="keyword">this</span>;

    <span class="keyword">this</span>.o = <span class="literal">null</span>; <span class="comment">// array of options</span>
    <span class="keyword">this</span>.$ = <span class="literal">null</span>; <span class="comment">// jQuery wrapped element</span>
    <span class="keyword">this</span>.i = <span class="literal">null</span>; <span class="comment">// mixed HTMLInputElement or array of HTMLInputElement</span>
    <span class="keyword">this</span>.g = <span class="literal">null</span>; <span class="comment">// 2D graphics context for 'pre-rendering'</span>
    <span class="keyword">this</span>.v = <span class="literal">null</span>; <span class="comment">// value ; mixed array or integer</span>
    <span class="keyword">this</span>.cv = <span class="literal">null</span>; <span class="comment">// change value ; not commited value</span>
    <span class="keyword">this</span>.x = <span class="number">0</span>; <span class="comment">// canvas x position</span>
    <span class="keyword">this</span>.y = <span class="number">0</span>; <span class="comment">// canvas y position</span>
    <span class="keyword">this</span>.$c = <span class="literal">null</span>; <span class="comment">// jQuery canvas element</span>
    <span class="keyword">this</span>.c = <span class="literal">null</span>; <span class="comment">// rendered canvas context</span>
    <span class="keyword">this</span>.isInit = <span class="literal">false</span>;
    <span class="keyword">this</span>.fgColor = <span class="literal">null</span>; <span class="comment">// main color</span>
    <span class="keyword">this</span>.dH = <span class="literal">null</span>; <span class="comment">// draw hook</span>
    <span class="keyword">this</span>.cH = <span class="literal">null</span>; <span class="comment">// change hook</span>
    <span class="keyword">this</span>.eH = <span class="literal">null</span>; <span class="comment">// cancel hook</span>
    <span class="keyword">this</span>.rH = <span class="literal">null</span>; <span class="comment">// release hook</span>

    <span class="keyword">this</span>.run = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
      <span class="keyword">var</span> cf = <span class="function"><span class="keyword">function</span> <span class="params">(e, conf)</span> {</span>
        <span class="keyword">var</span> k;
        <span class="keyword">for</span> (k <span class="keyword">in</span> conf) {
          s.o[k] = conf[k];
        }
        s.init();
        s._configure()
          ._draw();
      };

      <span class="keyword">if</span> (<span class="keyword">this</span>.$.data(<span class="string">'kontroled'</span>)) {
        <span class="keyword">return</span>;
      }
      <span class="keyword">this</span>.$.data(<span class="string">'kontroled'</span>, <span class="literal">true</span>);

      <span class="keyword">this</span>.extend();

      <span class="keyword">this</span>.o = $.extend({

</pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <h2>Default Options</h2>

<p><em>More information on these options <a href="https://github.com/aterrien/jQuery-Knob">here</a>.</em></p>             </td>             <td class="code">               <div class="highlight"><pre>
        min: <span class="keyword">this</span>.$.data(<span class="string">'min'</span>) || <span class="number">0</span>,
        max: <span class="keyword">this</span>.$.data(<span class="string">'max'</span>) || <span class="number">100</span>,
        stopper: <span class="literal">true</span>,
        readOnly: <span class="keyword">this</span>.$.data(<span class="string">'readonly'</span>),
        thickness: <span class="keyword">this</span>.$.data(<span class="string">'thickness'</span>) || <span class="number">0.4</span>,
        lineCap: <span class="keyword">this</span>.$.data(<span class="string">'linecap'</span>) || <span class="string">'butt'</span>,
        width: <span class="keyword">this</span>.$.data(<span class="string">'width'</span>) || <span class="number">200</span>,
        height: <span class="keyword">this</span>.$.data(<span class="string">'height'</span>) || <span class="number">200</span>,
        fgColor: <span class="keyword">this</span>.$.data(<span class="string">'fgcolor'</span>) || <span class="string">'#87CEEB'</span>,
        inputColor: <span class="keyword">this</span>.$.data(<span class="string">'inputcolor'</span>) || <span class="keyword">this</span>.$.data(<span class="string">'fgcolor'</span>) || <span class="string">'#87CEEB'</span>,
        inline: <span class="literal">false</span>,

</pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <h2>Added Options</h2>             </td>             <td class="code">               <div class="highlight"><pre>
</pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>Font size for label. Auto-calculates based on width if omitted.</p>             </td>             <td class="code">               <div class="highlight"><pre>        fontSize: <span class="keyword">this</span>.$.data(<span class="string">'fontsize'</span>)

      }, <span class="keyword">this</span>.o);

      <span class="keyword">this</span>.i = <span class="keyword">this</span>.$;
      <span class="keyword">this</span>.v = <span class="keyword">this</span>.$.val();
      (<span class="keyword">this</span>.v === <span class="string">''</span>) &amp;&amp; (<span class="keyword">this</span>.v = <span class="keyword">this</span>.o.min);

      <span class="keyword">this</span>.$.bind(<span class="string">'change'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
        s.val(s.$.val());
      });

      <span class="keyword">this</span>.$c = $(<span class="string">'&lt;canvas width="'</span> + <span class="keyword">this</span>.o.width + <span class="string">'px" height="'</span> + <span class="keyword">this</span>.o.height + <span class="string">'px"&gt;&lt;/canvas&gt;'</span>);
      <span class="keyword">this</span>.c = <span class="keyword">this</span>.$c[<span class="number">0</span>].getContext(<span class="string">"2d"</span>);

      <span class="keyword">this</span>.$.wrap($(<span class="string">'&lt;div style="position: relative; '</span> + (<span class="keyword">this</span>.o.inline ? <span class="string">'display:inline;'</span> : <span class="string">''</span>) +
        <span class="string">'width:'</span> + <span class="keyword">this</span>.o.width + <span class="string">'px;height:'</span> + <span class="keyword">this</span>.o.height + <span class="string">'px;"&gt;&lt;/div&gt;'</span>))
        .before(<span class="keyword">this</span>.$c);

      <span class="keyword">if</span> (<span class="keyword">this</span>.v <span class="keyword">instanceof</span> Object) {
        <span class="keyword">this</span>.cv = {};
        <span class="keyword">this</span>.copy(<span class="keyword">this</span>.v, <span class="keyword">this</span>.cv);
      } <span class="keyword">else</span> {
        <span class="keyword">this</span>.cv = <span class="keyword">this</span>.v;
      }

      <span class="keyword">this</span>.$.bind(<span class="string">"configure"</span>, cf)
        .parent()
        .bind(<span class="string">"configure"</span>, cf);

      <span class="keyword">this</span>._configure()
        ._xy()
        .init();

      <span class="keyword">this</span>.isInit = <span class="literal">true</span>;

      <span class="keyword">this</span>._draw();

      <span class="keyword">return</span> <span class="keyword">this</span>;
    };

    <span class="keyword">this</span>._draw = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
      <span class="keyword">var</span> d = <span class="literal">true</span>,
        c = document.createElement(<span class="string">'canvas'</span>);

      c.width = s.o.width;
      c.height = s.o.height;
      s.g = c.getContext(<span class="string">'2d'</span>);
      s.clear();
      s.dH &amp;&amp; (d = s.dH());

      (d !== <span class="literal">false</span>) &amp;&amp; s.draw();

      s.c.drawImage(c, <span class="number">0</span>, <span class="number">0</span>);
      c = <span class="literal">null</span>;
    };

    <span class="keyword">this</span>._xy = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
      <span class="keyword">var</span> o = <span class="keyword">this</span>.$c.offset();
      <span class="keyword">this</span>.x = o.left;
      <span class="keyword">this</span>.y = o.top;
      <span class="keyword">return</span> <span class="keyword">this</span>;
    };

    <span class="keyword">this</span>._configure = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
      <span class="keyword">this</span>.fgColor = <span class="keyword">this</span>.o.fgColor;
      <span class="keyword">return</span> <span class="keyword">this</span>;
    };

    <span class="keyword">this</span>._clear = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
      <span class="keyword">this</span>.$c[<span class="number">0</span>].width = <span class="keyword">this</span>.$c[<span class="number">0</span>].width;
    };

</pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>Abstract methods</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="keyword">this</span>.listen = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>}; <span class="comment">// on start, one time</span>
    <span class="keyword">this</span>.extend = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>}; <span class="comment">// each time configure triggered</span>
    <span class="keyword">this</span>.init = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>}; <span class="comment">// each time configure triggered</span>
    <span class="keyword">this</span>.change = <span class="function"><span class="keyword">function</span> <span class="params">(v)</span> {</span>}; <span class="comment">// on change</span>
    <span class="keyword">this</span>.val = <span class="function"><span class="keyword">function</span> <span class="params">(v)</span> {</span>}; <span class="comment">// on release</span>
    <span class="keyword">this</span>.xy2val = <span class="function"><span class="keyword">function</span> <span class="params">(x, y)</span> {</span>}; <span class="comment">//</span>
    <span class="keyword">this</span>.draw = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>}; <span class="comment">// on change / on release</span>
    <span class="keyword">this</span>.clear = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
      <span class="keyword">this</span>._clear();
    };

    <span class="keyword">this</span>.h2rgba = <span class="function"><span class="keyword">function</span> <span class="params">(h, a)</span> {</span>
      <span class="keyword">var</span> rgb;
      h = h.substring(<span class="number">1</span>, <span class="number">7</span>);
      rgb = [parseInt(h.substring(<span class="number">0</span>, <span class="number">2</span>), <span class="number">16</span>), parseInt(h.substring(<span class="number">2</span>, <span class="number">4</span>), <span class="number">16</span>), parseInt(h.substring(<span class="number">4</span>, <span class="number">6</span>), <span class="number">16</span>)];
      <span class="keyword">return</span> <span class="string">"rgba("</span> + rgb[<span class="number">0</span>] + <span class="string">","</span> + rgb[<span class="number">1</span>] + <span class="string">","</span> + rgb[<span class="number">2</span>] + <span class="string">","</span> + a + <span class="string">")"</span>;
    };

    <span class="keyword">this</span>.copy = <span class="function"><span class="keyword">function</span> <span class="params">(f, t)</span> {</span>
      <span class="keyword">for</span> (<span class="keyword">var</span> i <span class="keyword">in</span> f) {
        t[i] = f[i];
      }
    };
  };

  k.Dial = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>

    k.o.call(<span class="keyword">this</span>);

    <span class="keyword">this</span>.startAngle = <span class="literal">null</span>;
    <span class="keyword">this</span>.xy = <span class="literal">null</span>;
    <span class="keyword">this</span>.radius = <span class="literal">null</span>;
    <span class="keyword">this</span>.lineWidth = <span class="literal">null</span>;
    <span class="keyword">this</span>.w2 = <span class="literal">null</span>;
    <span class="keyword">this</span>.PI2 = <span class="number">2</span> * Math.PI;

    <span class="keyword">this</span>.extend = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
      <span class="keyword">this</span>.o = $.extend({
        bgColor: <span class="keyword">this</span>.$.data(<span class="string">'bgcolor'</span>) || <span class="string">'#EEEEEE'</span>,
        angleOffset: <span class="keyword">this</span>.$.data(<span class="string">'angleoffset'</span>) || <span class="number">0</span>,
        angleArc: <span class="keyword">this</span>.$.data(<span class="string">'anglearc'</span>) || <span class="number">360</span>,
        inline: <span class="literal">true</span>
      }, <span class="keyword">this</span>.o);
    };

    <span class="keyword">this</span>.val = <span class="function"><span class="keyword">function</span> <span class="params">(v)</span> {</span>
      <span class="keyword">if</span> (<span class="literal">null</span> !== v) {
        <span class="keyword">this</span>.cv = <span class="keyword">this</span>.o.stopper ? max(min(v, <span class="keyword">this</span>.o.max), <span class="keyword">this</span>.o.min) : v;
        <span class="keyword">this</span>.v = <span class="keyword">this</span>.cv;
        <span class="keyword">this</span>.$.val(<span class="keyword">this</span>.v);
        <span class="keyword">this</span>._draw();
      } <span class="keyword">else</span> {
        <span class="keyword">return</span> <span class="keyword">this</span>.v;
      }
    };

    <span class="keyword">this</span>.xy2val = <span class="function"><span class="keyword">function</span> <span class="params">(x, y)</span> {</span>
      <span class="keyword">var</span> a, ret;

      a = Math.atan2(
      x - (<span class="keyword">this</span>.x + <span class="keyword">this</span>.w2), -(y - <span class="keyword">this</span>.y - <span class="keyword">this</span>.w2)) - <span class="keyword">this</span>.angleOffset;

      <span class="keyword">if</span> (<span class="keyword">this</span>.angleArc != <span class="keyword">this</span>.PI2 &amp;&amp; (a &lt; <span class="number">0</span>) &amp;&amp; (a &gt; -<span class="number">0.5</span>)) {
        a = <span class="number">0</span>;
      } <span class="keyword">else</span> <span class="keyword">if</span> (a &lt; <span class="number">0</span>) {
        a += <span class="keyword">this</span>.PI2;
      }

      ret = ~~ (<span class="number">0.5</span> + (a * (<span class="keyword">this</span>.o.max - <span class="keyword">this</span>.o.min) / <span class="keyword">this</span>.angleArc)) + <span class="keyword">this</span>.o.min;

      <span class="keyword">this</span>.o.stopper &amp;&amp; (ret = max(min(ret, <span class="keyword">this</span>.o.max), <span class="keyword">this</span>.o.min));

      <span class="keyword">return</span> ret;
    };

    <span class="keyword">this</span>.init = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>

      <span class="keyword">if</span> ( <span class="keyword">this</span>.v &lt; <span class="keyword">this</span>.o.min || <span class="keyword">this</span>.v &gt; <span class="keyword">this</span>.o.max) {
        <span class="keyword">this</span>.v = <span class="keyword">this</span>.o.min;
      }

      <span class="keyword">this</span>.$.val(<span class="keyword">this</span>.v);
      <span class="keyword">this</span>.w2 = <span class="keyword">this</span>.o.width / <span class="number">2</span>;
      <span class="keyword">this</span>.xy = <span class="keyword">this</span>.w2;
      <span class="keyword">this</span>.lineWidth = <span class="keyword">this</span>.xy * <span class="keyword">this</span>.o.thickness;
      <span class="keyword">this</span>.lineCap = <span class="keyword">this</span>.o.lineCap;
      <span class="keyword">this</span>.radius = <span class="keyword">this</span>.xy - <span class="keyword">this</span>.lineWidth / <span class="number">2</span>;

      <span class="keyword">this</span>.o.angleOffset &amp;&amp; (<span class="keyword">this</span>.o.angleOffset = isNaN(<span class="keyword">this</span>.o.angleOffset) ? <span class="number">0</span> : <span class="keyword">this</span>.o.angleOffset);

      <span class="keyword">this</span>.o.angleArc &amp;&amp; (<span class="keyword">this</span>.o.angleArc = isNaN(<span class="keyword">this</span>.o.angleArc) ? <span class="keyword">this</span>.PI2 : <span class="keyword">this</span>.o.angleArc);

      <span class="keyword">this</span>.angleOffset = <span class="keyword">this</span>.o.angleOffset * Math.PI / <span class="number">180</span>;
      <span class="keyword">this</span>.angleArc = <span class="keyword">this</span>.o.angleArc * Math.PI / <span class="number">180</span>;

      <span class="keyword">this</span>.startAngle = <span class="number">1.5</span> * Math.PI + <span class="keyword">this</span>.angleOffset;
      <span class="keyword">this</span>.endAngle = <span class="number">1.5</span> * Math.PI + <span class="keyword">this</span>.angleOffset + <span class="keyword">this</span>.angleArc;

      <span class="keyword">var</span> s = max(String(Math.abs(<span class="keyword">this</span>.o.max)).length, String(Math.abs(<span class="keyword">this</span>.o.min)).length, <span class="number">2</span>) + <span class="number">2</span>;

      <span class="keyword">this</span>.i.css({
        <span class="string">'width'</span>: <span class="string">'0px'</span>,
        <span class="string">'visibility'</span>: <span class="string">'hidden'</span>
      });
    };

    <span class="keyword">this</span>.change = <span class="function"><span class="keyword">function</span> <span class="params">(v)</span> {</span>
      <span class="keyword">this</span>.cv = v;
      <span class="keyword">this</span>.$.val(v);
    };

    <span class="keyword">this</span>.angle = <span class="function"><span class="keyword">function</span> <span class="params">(v)</span> {</span>
      <span class="keyword">return</span> (v - <span class="keyword">this</span>.o.min) * <span class="keyword">this</span>.angleArc / (<span class="keyword">this</span>.o.max - <span class="keyword">this</span>.o.min);
    };

    <span class="keyword">this</span>.draw = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>

      <span class="keyword">var</span> c = <span class="keyword">this</span>.g,
        a = <span class="keyword">this</span>.angle(<span class="keyword">this</span>.cv),
        sat = <span class="keyword">this</span>.startAngle,
        eat = sat + a,
        sa, ea,
        r = <span class="number">1</span>;

      c.lineWidth = <span class="keyword">this</span>.lineWidth;
      c.lineCap = <span class="keyword">this</span>.lineCap;

      c.beginPath();
      c.strokeStyle = <span class="keyword">this</span>.o.bgColor;
      c.arc(<span class="keyword">this</span>.xy, <span class="keyword">this</span>.xy, <span class="keyword">this</span>.radius, <span class="keyword">this</span>.endAngle, <span class="keyword">this</span>.startAngle, <span class="literal">true</span>);
      c.stroke();
      c.beginPath();
      c.strokeStyle = r ? <span class="keyword">this</span>.o.fgColor : <span class="keyword">this</span>.fgColor;
      c.arc(<span class="keyword">this</span>.xy, <span class="keyword">this</span>.xy, <span class="keyword">this</span>.radius, sat, eat, <span class="literal">false</span>);
      c.stroke();
    };

    <span class="keyword">this</span>.cancel = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
      <span class="keyword">this</span>.val(<span class="keyword">this</span>.v);
    };
  };

  $.fn.simpleKnob = <span class="function"><span class="keyword">function</span> <span class="params">(o)</span> {</span>
    <span class="keyword">return</span> <span class="keyword">this</span>.each(

    <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>

      <span class="keyword">var</span> testElem = document.createElement(<span class="string">'canvas'</span>);

      <span class="keyword">if</span> (!(testElem.getContext &amp;&amp; testElem.getContext(<span class="string">'2d'</span>))) {
        <span class="keyword">return</span>;
      }

      <span class="keyword">var</span> d = <span class="keyword">new</span> k.Dial();
      d.o = o;
      d.$ = $(<span class="keyword">this</span>);
      d.run();
    }).parent();
  };

});
</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 