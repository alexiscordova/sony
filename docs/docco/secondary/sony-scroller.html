<!DOCTYPE html>  <html> <head>   <title>sony-scroller.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="debug_toggle.html">                 debug_toggle.js               </a>                                           <a class="source" href="form-actions.html">                 form-actions.js               </a>                                           <a class="source" href="jodo.rangecontrol.1.4.html">                 jodo.rangecontrol.1.4.js               </a>                                           <a class="source" href="jquery.shuffle.html">                 jquery.shuffle.js               </a>                                           <a class="source" href="jquery.simpleknob.html">                 jquery.simpleknob.js               </a>                                           <a class="source" href="jquery.simplescroll.html">                 jquery.simplescroll.js               </a>                                           <a class="source" href="jquery.viewport.html">                 jquery.viewport.js               </a>                                           <a class="source" href="sony-carousel-fade.html">                 sony-carousel-fade.js               </a>                                           <a class="source" href="sony-carousel.html">                 sony-carousel.js               </a>                                           <a class="source" href="sony-draggable.html">                 sony-draggable.js               </a>                                           <a class="source" href="sony-evenheights.html">                 sony-evenheights.js               </a>                                           <a class="source" href="sony-favorites.html">                 sony-favorites.js               </a>                                           <a class="source" href="sony-navigationdots.html">                 sony-navigationdots.js               </a>                                           <a class="source" href="sony-paddles.html">                 sony-paddles.js               </a>                                           <a class="source" href="sony-scroller.html">                 sony-scroller.js               </a>                                           <a class="source" href="sony-sequencer.html">                 sony-sequencer.js               </a>                                           <a class="source" href="sony-stickynav.html">                 sony-stickynav.js               </a>                                           <a class="source" href="sony-stickytabs.html">                 sony-stickytabs.js               </a>                                           <a class="source" href="sony-tab.html">                 sony-tab.js               </a>                                           <a class="source" href="sony-video.html">                 sony-video.js               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               sony-scroller.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre><span class="comment">/*global jQuery, Modernizr, IScroll, SONY */</span>

</pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <h2>Generic Scroller</h2>

<ul>
<li><strong>Version:</strong> 0.1</li>
<li><strong>Modified:</strong> 02/22/2013</li>
<li><strong>Authors:</strong> Telly Koosis, Tyler Madison, Glen Cheney</li>
<li><strong>Dependencies:</strong> jQuery 1.7+, Modernizr, <a href="sony-iscroll.html">sony-iscroll.js</a></li>
</ul>

<p><em>Example Usage:</em>
     TODO: add example here</p>             </td>             <td class="code">               <div class="highlight"><pre>

define(<span class="keyword">function</span>(require){

  <span class="string">'use strict'</span>;

  <span class="keyword">var</span> $ = require(<span class="string">'jquery'</span>),
      Modernizr = require(<span class="string">'modernizr'</span>),
      iQ = require(<span class="string">'iQ'</span>),
      Settings = require(<span class="string">'require/index'</span>).Settings,
      iScroll = require(<span class="string">'plugins/sony-iscroll'</span>);

  <span class="keyword">var</span> ScrollerModule = <span class="keyword">function</span>( $element, options ) {
    <span class="keyword">var</span> self = <span class="keyword">this</span>;

    $.extend(self, $.fn.scrollerModule.defaults, options, $.fn.scrollerModule.settings);

    self.$el = $element;
    self.$win = Settings.$window;
    self.unique = <span class="string">'.sm_'</span> + $.now();
    self._init();
  };

  ScrollerModule.prototype = {
    constructor: ScrollerModule,

    <span class="comment">/**
     * Private Methods
     */</span>

    _init : <span class="keyword">function</span>() {
      <span class="keyword">var</span> self = <span class="keyword">this</span>,
          resizeFunc = $.debounce( self.throttleTime, $.proxy( self._onResize, self ) );

      self.$contentContainer = self.contentSelector ? self.$el.find( self.contentSelector ) : self.$el.children().first();
      self.$elements = self.itemElementSelector ? self.$el.find( self.itemElementSelector ) : self.$contentContainer.children();
      self.$sampleElement = self.$elements.eq(<span class="number">0</span>);

      self.windowWidth = Settings.windowWidth;
      self.windowHeight = Settings.windowHeight;

</pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>Initially set the isPaginated boolean. This may be changed later inside paginate()</p>             </td>             <td class="code">               <div class="highlight"><pre>      self.isPaginated = self.mode === <span class="string">'paginate'</span>;

</pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>These don't change</p>             </td>             <td class="code">               <div class="highlight"><pre>      self.isPaginateMode = self.mode === <span class="string">'paginate'</span>;
      self.isCarouselMode = self.mode === <span class="string">'carousel'</span>;
      self.isFreeMode = self.mode === <span class="string">'free'</span>;

</pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>save iscroll properties</p>             </td>             <td class="code">               <div class="highlight"><pre>      self._setIscrollProps();

</pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>Set equal widths on the items in the carousel so they always take up as much space
as the container, then generate pagination for it.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="keyword">if</span> ( self.isCarouselMode ) {
        self._setItemWidths();
      }

</pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>Set the width of the inner container</p>             </td>             <td class="code">               <div class="highlight"><pre>      self._setContentWidth();

</pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>If carousel mode and generate pagination is true or not given, make it.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="keyword">if</span> ( self.isCarouselMode &amp;&amp; (self.generatePagination || self.generatePagination === <span class="literal">undefined</span>) ) {
        self._generatePagination( self.$elements.length );
      }

</pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>They haven't set whether they want to generate the nav or not.
Let's see if they've given us selectors for the nav paddles.
If they haven't and we're in carousel mode, generate the paddles for them.
Otherwise, we'll assume they don't want it.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="keyword">if</span> ( self.generateNav === <span class="literal">undefined</span> ) {
        self.generateNav = !self.nextSelector &amp;&amp; !self.prevSelector &amp;&amp; self.isCarouselMode;
      }

      <span class="keyword">if</span> ( self.generateNav ) {
        self._generateNavPaddles();
      }

</pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>Register our resize handler before iscroll's</p>             </td>             <td class="code">               <div class="highlight"><pre>      self.$win.on(self.resizeEvent + self.unique, resizeFunc);

</pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>Create instance of scroller and pass it defaults</p>             </td>             <td class="code">               <div class="highlight"><pre>      self.scroller = <span class="keyword">new</span> IScroll( self.$el[<span class="number">0</span>], self.iscrollProps );
      self.currentPage = self.scroller.currPageX;

</pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>Paddle clicks
If the selector is a jQuery object, use that, otherwise look for the selector inside our container</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="keyword">if</span> ( self.nextSelector ) {
        self.$navNext = self.nextSelector.jquery ? self.nextSelector : self.$el.find( self.nextSelector );
        self.$navNext.on(<span class="string">'click'</span>, <span class="keyword">function</span>( evt ) {
</pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>Stop the mouse click from bubbling up.</p>             </td>             <td class="code">               <div class="highlight"><pre>          evt.preventDefault();
          evt.stopPropagation();
          self.next();
        });
      }
      <span class="keyword">if</span> ( self.prevSelector ) {
        self.$navPrev = self.prevSelector.jquery ? self.prevSelector : self.$el.find( self.prevSelector );
        self.$navPrev.on(<span class="string">'click'</span>, <span class="keyword">function</span>( evt ) {
</pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>Stop the mouse click from bubbling up.</p>             </td>             <td class="code">               <div class="highlight"><pre>          evt.preventDefault();
          evt.stopPropagation();
          self.prev();
        });
      }

      self._update( <span class="literal">true</span> );
      self._showHideNavs( <span class="number">0</span>, self.scroller.pagesX.length - <span class="number">1</span> );
    },

    _setIscrollProps : <span class="keyword">function</span>() {
      <span class="keyword">var</span> self = <span class="keyword">this</span>;

</pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>Override the onscrollend for our own use</p>             </td>             <td class="code">               <div class="highlight"><pre>      self.onScrollEnd = self.iscrollProps.onScrollEnd;
      self.onAnimationEnd = self.iscrollProps.onAnimationEnd;
      self.onBeforeScrollStart = self.iscrollProps.onBeforeScrollStart;

      <span class="keyword">if</span> ( self.mode === <span class="string">'carousel'</span> ) {
        self.iscrollProps = {
          snap: <span class="literal">true</span>,
          hScrollbar: <span class="literal">false</span>,
          momentum: <span class="literal">false</span>
        };
</pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>self.iscrollProps.snap = true;
self.iscrollProps.hScrollbar = false;
self.momentum = false;</p>             </td>             <td class="code">               <div class="highlight"><pre>      }

</pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>NOT SURE WHY THIS ISN'T BEING CALLED</p>             </td>             <td class="code">               <div class="highlight"><pre>      self.iscrollProps.onScrollEnd = <span class="keyword">function</span>() {
        self._onScrollEnd( <span class="keyword">this</span> );
      };

</pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p>Pass the iScroll instance to our function (we still want <code>this</code> to reference ScrollerModule)</p>             </td>             <td class="code">               <div class="highlight"><pre>      self.iscrollProps.onAnimationEnd = <span class="keyword">function</span>() {
        self._onAnimationEnd( <span class="keyword">this</span> );
      };

</pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>Pass the iScroll instance to our function (we still want <code>this</code> to reference ScrollerModule)</p>             </td>             <td class="code">               <div class="highlight"><pre>      self.iscrollProps.onBeforeScrollStart = <span class="keyword">function</span>(e) {
        self._onBeforeScrollStart( <span class="keyword">this</span>, e);
      };




      <span class="keyword">return</span> self;
    },

    _paginate : <span class="keyword">function</span>() {
      <span class="keyword">var</span> self = <span class="keyword">this</span>,
          widthOfOneElement = self.$sampleElement.outerWidth(<span class="literal">true</span>),
          itemCount = self.$elements.length,
          containerWidth = self.$el.width() - self.extraSpacing,
          availToFit = self.fitPerPage || Math.floor(containerWidth / widthOfOneElement) || <span class="number">1</span>,
          numPages = Math.ceil( itemCount / availToFit ),
          i = <span class="number">0</span>,
          totalBlockWidth = widthOfOneElement * availToFit;

</pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <p>Add back the extra spacing we took away for previous calculations</p>             </td>             <td class="code">               <div class="highlight"><pre>      containerWidth += self.extraSpacing;

</pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <p>Add extra marging</p>             </td>             <td class="code">               <div class="highlight"><pre>      containerWidth += self.extraMarging;

</pre></div>             </td>           </tr>                               <tr id="section-22">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-22">&#182;</a>               </div>               <p>Update the width again to the new width based on however many 'pages' there are now</p>             </td>             <td class="code">               <div class="highlight"><pre>      self._setContentWidth( numPages, containerWidth );

</pre></div>             </td>           </tr>                               <tr id="section-23">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-23">&#182;</a>               </div>               <p>stop processing function /maybe hide paddles or UI?</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="keyword">if</span> ( numPages === <span class="number">1</span> || availToFit &gt; itemCount ) {
        <span class="keyword">return</span> <span class="literal">false</span>;
      }

      <span class="function"><span class="keyword">function</span> <span class="title">buildPage</span><span class="params">(pageNum, startIndex, endIndex)</span> {</span>
        <span class="keyword">var</span> $elemsInPage = self.$elements.slice(startIndex, endIndex + <span class="number">1</span>),
            offsetX,
            startX;

        <span class="keyword">if</span> ( pageNum === numPages - <span class="number">1</span> &amp;&amp; self.lastPageCenter ) {
          totalBlockWidth = self.$sampleElement.outerWidth(<span class="literal">true</span>) * $elemsInPage.length;
        }

        offsetX = self.centerItems ? Math.floor((containerWidth - totalBlockWidth) * <span class="number">0.5</span>) : <span class="number">0</span>;
        startX = Math.floor((pageNum * containerWidth) + offsetX);

        $elemsInPage.css({
          <span class="string">'position'</span> : <span class="string">'absolute'</span>,
          <span class="string">'top'</span> : <span class="string">'0'</span>,
          <span class="string">'left'</span> : <span class="string">'0'</span>
        });


        $.each($elemsInPage , <span class="keyword">function</span>(i) {
          <span class="keyword">var</span> $el = $(<span class="keyword">this</span>);

          <span class="keyword">if</span> ( self.autoGutters ) {
            $el.css( <span class="string">'left'</span> , Math.floor(startX + (i * $el.outerWidth(<span class="literal">true</span>))) + <span class="string">'px'</span> );
          } <span class="keyword">else</span> {
            <span class="keyword">if</span> ( i === <span class="number">0</span> ) {
              $el.css( <span class="string">'left'</span> , Math.floor( startX + (i * $el.outerWidth()) ) + <span class="string">'px'</span> );
            } <span class="keyword">else</span> {
              $el.css( <span class="string">'left'</span> , Math.floor( startX + (i * $el.outerWidth()) ) + (i * self.gutterWidth) + <span class="string">'px'</span> );
            }
          }

        });
      }

</pre></div>             </td>           </tr>                               <tr id="section-24">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-24">&#182;</a>               </div>               <p>Generate nav bullets ( if wanted )</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="keyword">if</span> ( self.generatePagination ) {
        self._generatePagination( numPages );
      }

</pre></div>             </td>           </tr>                               <tr id="section-25">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-25">&#182;</a>               </div>               <p>Space elements out accordingly</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="keyword">for</span> ( ; i &lt; numPages; i++) {
        <span class="keyword">var</span> startIndex = i * availToFit,
            endIndex = startIndex + availToFit - <span class="number">1</span>;

        buildPage( i , startIndex , endIndex );
      }


</pre></div>             </td>           </tr>                               <tr id="section-26">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-26">&#182;</a>               </div>               <p>Save values for later outsiders if they want it</p>             </td>             <td class="code">               <div class="highlight"><pre>      self.totalPages = numPages;
      self.itemsPerPage = availToFit;

      self._fire(<span class="string">'paginationcomplete'</span>);

      <span class="keyword">return</span> <span class="literal">true</span>;
    },

    _generatePagination : <span class="keyword">function</span>( pages ) {

      <span class="keyword">var</span> self = <span class="keyword">this</span>,
          $elementToAppend = self.appendBulletsTo ? $(self.appendBulletsTo) : self.$el;

      <span class="keyword">if</span> ( !$.fn.sonyNavDots ) {
        <span class="keyword">return</span>;
      }

      <span class="keyword">if</span> ( self.$pagination ) {
        self.$pagination.sonyNavDots(<span class="string">'reset'</span>, {
          <span class="string">'buttonCount'</span>: pages
        });
        <span class="keyword">return</span>;
      }

      self.$pagination = $(<span class="string">'&lt;div/&gt;'</span>, { <span class="string">'class'</span> : <span class="string">'navigation-container'</span> });

      $elementToAppend.append( self.$pagination );

      self.$pagination.sonyNavDots({
        <span class="string">'buttonCount'</span>: pages
      });

      self.$pagination.on(<span class="string">'SonyNavDots:clicked'</span>, <span class="keyword">function</span>(e, a){
        self.gotopage(a);
      });
    },

    _generateNavPaddles : <span class="keyword">function</span>() {
      <span class="keyword">var</span> self = <span class="keyword">this</span>,
          $nav = $( self.navTemplate ),
          $prev = $nav.find(<span class="string">'.nav-paddle-prev'</span>),
          $next = $nav.find(<span class="string">'.nav-paddle-next'</span>),
          $parent = self.appendNavOutside ? self.$el.parent() : self.$el;

      $parent
        .append( $nav )
        .addClass(  self.paddleTrigger );

      self.$nav = $nav;
      self.prevSelector = $prev;
      self.nextSelector = $next;
    },

    _update : <span class="keyword">function</span>( isInit ) {
      <span class="keyword">var</span> self = <span class="keyword">this</span>;

</pre></div>             </td>           </tr>                               <tr id="section-27">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-27">&#182;</a>               </div>               <p>Paginate() will return false if there aren't enough items to be paginated
If there aren't enough items, we don't want to create an iScroll instance</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="keyword">if</span> ( self.mode === <span class="string">'paginate'</span> ) {
        self.isPaginated = self._paginate();
      }

</pre></div>             </td>           </tr>                               <tr id="section-28">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-28">&#182;</a>               </div>               <p>If this is running on init, we've already set the values, so skip it</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="keyword">if</span> ( !isInit ) {
</pre></div>             </td>           </tr>                               <tr id="section-29">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-29">&#182;</a>               </div>               <p>Set the width of the element containing all the items</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="keyword">if</span> ( self.isCarouselMode ) {
          self._setItemWidths();
        }

</pre></div>             </td>           </tr>                               <tr id="section-30">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-30">&#182;</a>               </div>               <p>We need to update the container's width</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="keyword">if</span> ( self.isCarouselMode || self.isFreeMode ) {
          self._setContentWidth();
        }
      }

</pre></div>             </td>           </tr>                               <tr id="section-31">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-31">&#182;</a>               </div>               <p>When <code>isPaginated</code> or <code>isCarouselMode</code>, we're using iscroll, which needs to be updated.
However, only <code>isPaginated</code> needs an update on init</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="keyword">if</span> ( isInit &amp;&amp; self.isPaginated ) {
        self.scroller.refresh();
      } <span class="keyword">else</span> <span class="keyword">if</span> ( !isInit &amp;&amp; (self.isPaginated || self.isCarouselMode || self.isFreeMode) ) {
        self.scroller.refresh();
</pre></div>             </td>           </tr>                               <tr id="section-32">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-32">&#182;</a>               </div>               <p>As long as this isn't the initial setup, scroll to the current page.
We don't want to call this on init because it calls the <code>onScrollStart</code> function/option
Which might not have a reference to the scroller yet</p>             </td>             <td class="code">               <div class="highlight"><pre>        self.scroller.scrollToPage(self.currentPage, <span class="number">0</span>, <span class="number">400</span>);
      }

      self._fire(<span class="string">'update'</span>);
    },

</pre></div>             </td>           </tr>                               <tr id="section-33">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-33">&#182;</a>               </div>               <p>Throttled resize event</p>             </td>             <td class="code">               <div class="highlight"><pre>    _onResize : <span class="keyword">function</span>() {
      <span class="keyword">var</span> self = <span class="keyword">this</span>,
          windowWidth = self.$win.width(),
          windowHeight = self.$win.height(),
          hasWindowChanged = windowWidth !== self.windowWidth || windowHeight !== self.windowHeight;

      <span class="keyword">if</span> ( self.destroyed || !hasWindowChanged || !self.enabled ) {
        <span class="keyword">return</span>;
      }

      self.windowWidth = windowWidth;
      self.windowHeight = windowHeight;

      self._update();
    },

    _onScrollEnd : <span class="keyword">function</span>( iscroll ) {
      <span class="keyword">var</span> self = <span class="keyword">this</span>;

      self._fire(<span class="string">'scrolled'</span>);

</pre></div>             </td>           </tr>                               <tr id="section-34">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-34">&#182;</a>               </div>               <p>If they've defined a callback as well, call it
We saved their function to this reference so we could have our own onScrollEnd</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="keyword">if</span> ( self.onScrollEnd ) {
        self.onScrollEnd.call( iscroll, iscroll );
      }
    },

    _showHideNavs : <span class="keyword">function</span>( currentPage, numPages ) {
      <span class="keyword">var</span> self = <span class="keyword">this</span>,
          theClass = <span class="string">'hidden'</span>;

      <span class="keyword">if</span> ( self.$navPrev &amp;&amp; self.$navNext ) {
</pre></div>             </td>           </tr>                               <tr id="section-35">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-35">&#182;</a>               </div>               <p>Hide show prev button depending on where we are</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="keyword">if</span> ( currentPage === <span class="number">0</span> ) {
          self.$navPrev.addClass( theClass );
        } <span class="keyword">else</span> {
          self.$navPrev.removeClass( theClass );
        }

</pre></div>             </td>           </tr>                               <tr id="section-36">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-36">&#182;</a>               </div>               <p>Hide show next button depending on where we are</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="keyword">if</span> ( currentPage === numPages ) {
          self.$navNext.addClass( theClass );
        } <span class="keyword">else</span> {
          self.$navNext.removeClass( theClass );
        }
      }
    },

    _onBeforeScrollStart : <span class="keyword">function</span>( iscroll, e ){
      <span class="keyword">var</span> self = <span class="keyword">this</span>,
          distX = iscroll.absDistX || <span class="number">0</span>,
          distY = iscroll.absDistY || <span class="number">0</span>;

</pre></div>             </td>           </tr>                               <tr id="section-37">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-37">&#182;</a>               </div>               <p>if vertical scrolling passes threshhold then "lock direction"</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="keyword">if</span> ( distX &gt;= (distY + self.threshhold ) ) {
</pre></div>             </td>           </tr>                               <tr id="section-38">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-38">&#182;</a>               </div>               <p>prevent the browsers' native scrolling</p>             </td>             <td class="code">               <div class="highlight"><pre>        e.preventDefault();
      }

</pre></div>             </td>           </tr>                               <tr id="section-39">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-39">&#182;</a>               </div>               <p>If they've defined a callback as well, call it
Original function is saved as reference (self.onBeforeScrollStart) so we could have a custom onBeforeScrollStart</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="keyword">if</span> ( self.onBeforeScrollStart ) {
        self.onBeforeScrollStart.call( iscroll, iscroll );
      }
    },

    _onAnimationEnd : <span class="keyword">function</span>( iscroll ) {
      <span class="keyword">var</span> self = <span class="keyword">this</span>;


      <span class="keyword">if</span> ( iscroll.pagesX &amp;&amp; iscroll.pagesX.length ){

        self.currentPage = iscroll.currPageX;

</pre></div>             </td>           </tr>                               <tr id="section-40">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-40">&#182;</a>               </div>               <p>Show or hide paddles based on our current page</p>             </td>             <td class="code">               <div class="highlight"><pre>        self._showHideNavs( self.currentPage, iscroll.pagesX.length - <span class="number">1</span> );

</pre></div>             </td>           </tr>                               <tr id="section-41">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-41">&#182;</a>               </div>               <p>Update nav bullets</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="keyword">if</span> ( self.$pagination ) {
          self.$pagination.sonyNavDots(<span class="string">'reset'</span>, {
            <span class="string">'activeButton'</span>: self.currentPage
          });
        }

      }

</pre></div>             </td>           </tr>                               <tr id="section-42">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-42">&#182;</a>               </div>               <p>If they've defined a callback as well, call it
We saved their function to this reference so we could have our own onAnimationEnd</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="keyword">if</span> ( self.onAnimationEnd ) {
        self.onAnimationEnd.call( iscroll, iscroll );
      }
    },

    _setContentWidth : <span class="keyword">function</span>( numPages, containerWidth ) {
      <span class="keyword">var</span> self = <span class="keyword">this</span>,
          contentWidth = <span class="number">0</span>;

</pre></div>             </td>           </tr>                               <tr id="section-43">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-43">&#182;</a>               </div>               <p>If we're not given a number of pages, calculate it based on the width of each item</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="keyword">if</span> ( !numPages ) {
</pre></div>             </td>           </tr>                               <tr id="section-44">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-44">&#182;</a>               </div>               <p>They've given us a function that will retun the container width</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="keyword">if</span> ( <span class="keyword">typeof</span> self.getContentWidth === <span class="string">'function'</span> ) {
          contentWidth = self.getContentWidth( self.$elements );

</pre></div>             </td>           </tr>                               <tr id="section-45">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-45">&#182;</a>               </div>               <p>Calculate it ourselves</p>             </td>             <td class="code">               <div class="highlight"><pre>        } <span class="keyword">else</span> {
          self.$elements.each(<span class="keyword">function</span>() {
            contentWidth += Math.round($(<span class="keyword">this</span>).outerWidth(<span class="literal">true</span>));
          });
        }
      } <span class="keyword">else</span> {
        contentWidth = numPages * containerWidth;
      }

</pre></div>             </td>           </tr>                               <tr id="section-46">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-46">&#182;</a>               </div>               <p>Set it</p>             </td>             <td class="code">               <div class="highlight"><pre>      self.$contentContainer.css( <span class="string">'width'</span> , contentWidth );

      <span class="keyword">return</span> self;
    },

    _setItemWidths : <span class="keyword">function</span>() {
      <span class="keyword">var</span> self = <span class="keyword">this</span>,
          containerWidth = self.$el.width();

      self.$elements.css( <span class="string">'width'</span>, containerWidth );
    },

    _fire : <span class="keyword">function</span>( eventName, args ) {
      <span class="keyword">this</span>.$el.trigger( eventName + <span class="string">'.sm'</span>, args || [<span class="keyword">this</span>] );

      <span class="keyword">return</span> <span class="keyword">this</span>;
    },

    <span class="comment">/**
     * Public Methods
     */</span>

    setGutterWidth: <span class="keyword">function</span>(gutterWidth){
      <span class="keyword">var</span> self = <span class="keyword">this</span>;
      self.gutterWidth = gutterWidth;
    },

    setFitPerPage: <span class="keyword">function</span>(fitPerPage){
      <span class="keyword">var</span> self = <span class="keyword">this</span>;
      self.fitPerPage = fitPerPage;
    },

    setExtraMarging: <span class="keyword">function</span>(extraMarging){
      <span class="keyword">var</span> self = <span class="keyword">this</span>;
      self.extraMarging = extraMarging;
    },

    gotopage: <span class="keyword">function</span>( pageNumber, duration ) {
      duration = duration || <span class="number">400</span>;
      <span class="keyword">this</span>.scroller.scrollToPage(pageNumber, <span class="number">0</span>, duration);
    },

    next: <span class="keyword">function</span>() {
      <span class="keyword">this</span>.gotopage(<span class="string">'next'</span>);
    },

    prev: <span class="keyword">function</span>() {
      <span class="keyword">this</span>.gotopage(<span class="string">'prev'</span>);
    },

    refresh: <span class="keyword">function</span>() {
      <span class="keyword">this</span>._update();
    },

    destroy: <span class="keyword">function</span>() {
      <span class="keyword">var</span> self = <span class="keyword">this</span>;

      <span class="keyword">if</span> ( self.$pagination ) {
        self.$pagination.remove();
      }

      <span class="keyword">if</span> ( self.generateNav ) {
        self.$nav.remove();

</pre></div>             </td>           </tr>                               <tr id="section-47">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-47">&#182;</a>               </div>               <p>We added a paddle trigger class to one of the parents, lets find the parent and remove it.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="keyword">if</span> ( self.addPaddleTrigger ) {
</pre></div>             </td>           </tr>                               <tr id="section-48">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-48">&#182;</a>               </div>               <p>$().closest search the current element and then up the tree until it finds the selector</p>             </td>             <td class="code">               <div class="highlight"><pre>          self.$el.closest( self.paddleTrigger ).removeClass( self.paddleTrigger);
        }
      }

      self.$contentContainer.css(<span class="string">'width'</span>, <span class="string">''</span>);
      self.$elements.css({
        <span class="string">'position'</span> : <span class="string">''</span>,
        <span class="string">'top'</span> : <span class="string">''</span>,
        <span class="string">'left'</span> : <span class="string">''</span>
      });

      <span class="keyword">if</span> ( self.isCarouselMode ) {
        self.$elements.css(<span class="string">'width'</span>, <span class="string">''</span>);
      }

</pre></div>             </td>           </tr>                               <tr id="section-49">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-49">&#182;</a>               </div>               <p>Flag to know it's destroyed</p>             </td>             <td class="code">               <div class="highlight"><pre>      self.destroyed = <span class="literal">true</span>;

</pre></div>             </td>           </tr>                               <tr id="section-50">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-50">&#182;</a>               </div>               <p>Destroy the scroller</p>             </td>             <td class="code">               <div class="highlight"><pre>      self.scroller.destroy();
</pre></div>             </td>           </tr>                               <tr id="section-51">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-51">&#182;</a>               </div>               <p>self.scroller = null;</p>             </td>             <td class="code">               <div class="highlight"><pre>
</pre></div>             </td>           </tr>                               <tr id="section-52">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-52">&#182;</a>               </div>               <p>Remove resize event</p>             </td>             <td class="code">               <div class="highlight"><pre>      self.$win.off( self.unique );

      self.$el.removeData(<span class="string">'scrollerModule'</span>);
    },

    disable: <span class="keyword">function</span>() {
      <span class="keyword">this</span>.enabled = <span class="literal">false</span>;
      <span class="keyword">this</span>.scroller.disable();
    },

    enable: <span class="keyword">function</span>() {
      <span class="keyword">this</span>.enabled = <span class="literal">true</span>;
      <span class="keyword">this</span>.scroller.enable();
    }
  };

</pre></div>             </td>           </tr>                               <tr id="section-53">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-53">&#182;</a>               </div>               <p>Plugin definition</p>             </td>             <td class="code">               <div class="highlight"><pre>  $.fn.scrollerModule = <span class="keyword">function</span>( options ) {
    <span class="keyword">var</span> args = Array.prototype.slice.call( arguments, <span class="number">1</span> );
    <span class="keyword">return</span> <span class="keyword">this</span>.each(<span class="keyword">function</span>() {
      <span class="keyword">var</span> self = $(<span class="keyword">this</span>),
          scrollerModule = self.data(<span class="string">'scrollerModule'</span>);

</pre></div>             </td>           </tr>                               <tr id="section-54">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-54">&#182;</a>               </div>               <p>If we don't have a stored scrollerModule, make a new one and save it</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="keyword">if</span> ( !scrollerModule ) {
        scrollerModule = <span class="keyword">new</span> ScrollerModule( self, options );
        self.data( <span class="string">'scrollerModule'</span>, scrollerModule );
      }

      <span class="keyword">if</span> ( <span class="keyword">typeof</span> options === <span class="string">'string'</span> &amp;&amp; options.charAt(<span class="number">0</span>) !== <span class="string">'_'</span> ) {
        scrollerModule[ options ].apply( scrollerModule, args );
      }
    });
  };

</pre></div>             </td>           </tr>                               <tr id="section-55">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-55">&#182;</a>               </div>               <p>Defaults</p>             </td>             <td class="code">               <div class="highlight"><pre>  $.fn.scrollerModule.defaults = {
    mode: <span class="string">'free'</span>, <span class="comment">// if mode == 'paginate', the items in the container will be paginated</span>
    contentSelector: <span class="literal">undefined</span>, <span class="comment">// parent of items in scroller</span>
    itemElementSelector: <span class="literal">undefined</span>, <span class="comment">// items in scroller</span>
    lastPageCenter: <span class="literal">false</span>, <span class="comment">// option to center last page elements</span>
    extraSpacing: <span class="number">0</span>, <span class="comment">// per page</span>
    extraMarging: <span class="number">0</span>, <span class="comment">// per page</span>
    nextSelector: <span class="string">''</span>, <span class="comment">// selector for next paddle</span>
    prevSelector: <span class="string">''</span>, <span class="comment">// selector for previous paddle</span>
    fitPerPage: <span class="literal">null</span>, <span class="comment">// if content needs to be fixed per page</span>
    centerItems: <span class="literal">true</span>, <span class="comment">// centers items per page</span>
    generatePagination: <span class="literal">undefined</span>, <span class="comment">// if bullet pagination is needed in mode = paginate,</span>
    generateNav: <span class="literal">undefined</span>, <span class="comment">// if left undefined, nav will be generated for carousel modes with no next/prev selectors</span>
    appendBulletsTo: <span class="literal">null</span>, <span class="comment">// option on where to place pagination bullets, if null defaults to self.$el</span>
    appendNavOutside: <span class="literal">true</span>, <span class="comment">// Outside the scroller ($el). You probably want this because the scroller has overflow:hidden</span>
    addPaddleTrigger: <span class="literal">true</span>, <span class="comment">// Add the paddle-trigger class to fade in paddles when the parent is hovered</span>
    autoGutters: <span class="literal">true</span>,
    gutterWidth: <span class="number">0</span>,
    threshhold: <span class="number">5</span>, <span class="comment">// in pixels, determines when native scrolling is prevented (used with onBeforeScrollStart)</span>

</pre></div>             </td>           </tr>                               <tr id="section-56">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-56">&#182;</a>               </div>               <p>iscroll props get mixed in</p>             </td>             <td class="code">               <div class="highlight"><pre>    iscrollProps: {
      snap: <span class="literal">false</span>,
      hScroll: <span class="literal">true</span>,
      vScroll: <span class="literal">false</span>,
      hScrollbar: <span class="literal">false</span>,
      vScrollbar: <span class="literal">false</span>,
      momentum: <span class="literal">true</span>,
      bounce: <span class="literal">true</span>,
      onScrollEnd: <span class="literal">null</span>,
      lockDirection: <span class="literal">true</span>,
      onBeforeScrollStart: <span class="literal">null</span>,
      onAnimationEnd: <span class="literal">null</span>
    }

  };

</pre></div>             </td>           </tr>                               <tr id="section-57">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-57">&#182;</a>               </div>               <p>Not overrideable</p>             </td>             <td class="code">               <div class="highlight"><pre>  $.fn.scrollerModule.settings = {
    enabled: <span class="literal">true</span>,
    throttleTime: <span class="number">350</span>, <span class="comment">// How much the resize event is throttled (milliseconds)</span>
    paginationClass: <span class="string">'pagination-bullet'</span>,
    paddleTrigger:  <span class="string">'paddle-trigger'</span>,
    resizeEvent: <span class="string">'onorientationchange'</span> <span class="keyword">in</span> window ? <span class="string">'orientationchange'</span> : <span class="string">'resize'</span>,
    navTemplate: <span class="string">'&lt;nav class="nav-paddles"&gt;&lt;button class="nav-paddle nav-paddle-prev"&gt;&lt;i class="fonticon-10-chevron-reverse"&gt;&lt;/i&gt;&lt;/button&gt;&lt;button class="nav-paddle nav-paddle-next"&gt;&lt;i class="fonticon-10-chevron"&gt;&lt;/i&gt;&lt;/button&gt;&lt;/nav&gt;'</span>
  };

});

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 