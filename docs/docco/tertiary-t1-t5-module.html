<!DOCTYPE html>  <html> <head>   <title>tertiary-t1-t5-module.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="brightcove-builder.html">                 brightcove-builder.js               </a>                                           <a class="source" href="editorial-dual-viewer-e9.html">                 editorial-dual-viewer-e9.js               </a>                                           <a class="source" href="form-actions.html">                 form-actions.js               </a>                                           <a class="source" href="global-nav.html">                 global-nav.js               </a>                                           <a class="source" href="hotspot_explorer.html">                 hotspot_explorer.js               </a>                                           <a class="source" href="jquery.viewport.html">                 jquery.viewport.js               </a>                                           <a class="source" href="primary-tout-p1-d7.html">                 primary-tout-p1-d7.js               </a>                                           <a class="source" href="related-products.html">                 related-products.js               </a>                                           <a class="source" href="sony-gallery.html">                 sony-gallery.js               </a>                                           <a class="source" href="sony-one-carousel.html">                 sony-one-carousel.js               </a>                                           <a class="source" href="sony-sequencer.html">                 sony-sequencer.js               </a>                                           <a class="source" href="spec-multi-z2.html">                 spec-multi-z2.js               </a>                                           <a class="source" href="spec-single-z1.html">                 spec-single-z1.js               </a>                                           <a class="source" href="tertiary-t1-t5-module.html">                 tertiary-t1-t5-module.js               </a>                                           <a class="source" href="ux-marketing-convergence-e14.html">                 ux-marketing-convergence-e14.js               </a>                                           <a class="source" href="exports.html">                 exports.js               </a>                                           <a class="source" href="iq.html">                 iq.js               </a>                                           <a class="source" href="sony-global-analytics.html">                 sony-global-analytics.js               </a>                                           <a class="source" href="sony-global-settings.html">                 sony-global-settings.js               </a>                                           <a class="source" href="sony-global-utilities.html">                 sony-global-utilities.js               </a>                                           <a class="source" href="sony-global.html">                 sony-global.js               </a>                                           <a class="source" href="debug_toggle.html">                 debug_toggle.js               </a>                                           <a class="source" href="jodo.rangecontrol.1.4.html">                 jodo.rangecontrol.1.4.js               </a>                                           <a class="source" href="jquery.shuffle.html">                 jquery.shuffle.js               </a>                                           <a class="source" href="jquery.simpleknob.html">                 jquery.simpleknob.js               </a>                                           <a class="source" href="jquery.simplescroll.html">                 jquery.simplescroll.js               </a>                                           <a class="source" href="sony-draggable.html">                 sony-draggable.js               </a>                                           <a class="source" href="sony-evenheights.html">                 sony-evenheights.js               </a>                                           <a class="source" href="sony-scroller.html">                 sony-scroller.js               </a>                                           <a class="source" href="sony-stickytabs.html">                 sony-stickytabs.js               </a>                                           <a class="source" href="sony-tab.html">                 sony-tab.js               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               tertiary-t1-t5-module.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre><span class="comment">/*global jQuery, Modernizr, Sequencer*/</span>

</pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <h2>Sony Tertiary Content Container</h2>

<ul>
<li><strong>Module:</strong> Tertiary Module</li>
<li><strong>Version:</strong> 0.1</li>
<li><strong>Modified:</strong> 02/14/2013</li>
<li><strong>Author:</strong> Telly Koosis</li>
<li><strong>Dependencies:</strong> jQuery 1.7+, Modernizr, <a href="sony-iscroll.html">sony-iscroll.js</a>, <a href="sony-scroller.html">sony-scroller.js</a>, <a href="sony-sequencer.html">sony-sequencer.js</a></li>
</ul>

<p><em>Example Usage:</em>
     Automatic detection of .tcc-scroller on page
     $('.tcc-wrapper').tertiaryModule({}).data('tertiaryModule');</p>             </td>             <td class="code">               <div class="highlight"><pre>
(<span class="keyword">function</span>($, Modernizr, window, <span class="literal">undefined</span>) {
    
    <span class="string">'use strict'</span>;

    <span class="keyword">var</span> TertiaryModule = <span class="keyword">function</span>(element, options){
      <span class="keyword">var</span> self                 = <span class="keyword">this</span>;
      
      $.extend(self, {}, $.fn.tertiaryModule.defaults, options, $.fn.tertiaryModule.settings);
      
      self.$container              = $( element );
      self.containerId             = <span class="string">'#'</span> + self.$container.attr(<span class="string">"id"</span>);
      self.$el                     = self.$container.find(<span class="string">".tcc-scroller"</span>);
      self.$win                    = $( window );
      self.$doc                    = $( window.document );
      self.ev                      = $( {} ); <span class="comment">//event object</span>
      
      self.mode                    = <span class="literal">null</span>;
      
      self.contentModulesClass     = <span class="string">'.tcc-content-module'</span>;
      self.contentSelectorClass    = <span class="string">'.tcc-body'</span>;
      self.$tccHeaderWrapper       = self.$container.find(<span class="string">'.tcc-header-wrapper'</span>);
      self.$tccHeader              = self.$tccHeaderWrapper.find(<span class="string">".tcc-header"</span>);
      self.$tccBodyWrapper         = self.$el;
      self.$tccBody                = self.$tccBodyWrapper.find(self.contentSelectorClass);
      self.$contentModules         = self.$el.find(self.contentModulesClass);
      self.$hideShowEls            = self.$tccBodyWrapper.add(self.$tccBody).add(self.$contentModules);
      self.$loader                 = self.$container.find(<span class="string">".loader"</span>);

      self.$scrollerInstance       = <span class="literal">null</span>;
               
      self.resizeEvent             = <span class="string">'onorientationchange'</span> <span class="keyword">in</span> window ? <span class="string">'orientationchange'</span> : <span class="string">'resize'</span>;
      self.resizeThrottle          = <span class="keyword">function</span>(){self.handleResize();};
      
      self.hasTouch                = <span class="string">'ontouchstart'</span> <span class="keyword">in</span> window || <span class="string">'createTouch'</span> <span class="keyword">in</span> self.$doc ? <span class="literal">true</span> : <span class="literal">false</span>;
      self.tapOrClick              = <span class="keyword">function</span>(){<span class="keyword">return</span> self.hasTouch ? <span class="string">'touchend'</span> : <span class="string">'click'</span>;};
      
      self.sequencerSpeed          = <span class="number">250</span>;
      self.hideShowSpeed           = <span class="number">250</span>;
      self.debounceSpeed           = <span class="number">300</span>;
      
      self.phoneBreakpoint         = <span class="number">479</span>;
      self.tabletBreakpointMin     = self.phoneBreakpoint + <span class="number">1</span>;
      self.tabletBreakpointMax     = <span class="number">768</span>;

      self.marginPercent          = Number(<span class="string">'.0334'</span>); <span class="comment">// 22/650 (at 2-up)</span>
      self.paddingPerContent      = <span class="number">20</span>;

</pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>a non-debounced resize event so content is hidden immediately</p>             </td>             <td class="code">               <div class="highlight"><pre>      $(window).on(<span class="string">'resize'</span>, <span class="keyword">function</span>(){
        <span class="keyword">if</span>(self.mode !== <span class="string">"desktop"</span>){
          
</pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>hide content modules </p>             </td>             <td class="code">               <div class="highlight"><pre>          self.$hideShowEls.css({
            <span class="string">'opacity'</span> : <span class="number">0</span>,
            <span class="string">'visibility'</span> : <span class="string">'hidden'</span>
          });

</pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>once content is hidden, show loader icon </p>             </td>             <td class="code">               <div class="highlight"><pre>         self.showLoader();
        }

      });

</pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>define resize listener, debounced</p>             </td>             <td class="code">               <div class="highlight"><pre>      self.$win.on(self.resizeEvent + <span class="string">'.tcc'</span>, $.debounce(self.debounceSpeed, self.resizeThrottle));     

</pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>start it</p>             </td>             <td class="code">               <div class="highlight"><pre>      self.init();
    };

    TertiaryModule.prototype = {
      constructor: TertiaryModule,

      init : <span class="keyword">function</span>() {

        <span class="keyword">var</span> self = <span class="keyword">this</span>;

</pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>TODO: if needed, add sequencer here. </p>             </td>             <td class="code">               <div class="highlight"><pre>        self.setMode();
     
</pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>if screen size is in mobile (tablet, phone) mode then create a scroller</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="keyword">if</span>(self.mode !== <span class="string">'desktop'</span>){
          self.setup();
        }
      },

</pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>controller for scroller setup</p>             </td>             <td class="code">               <div class="highlight"><pre>      setup : <span class="keyword">function</span>(){
        <span class="keyword">var</span> self      = <span class="keyword">this</span>,
            setupSequence = <span class="keyword">new</span> Sequencer();

</pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>define order of events via sequencer        </p>             </td>             <td class="code">               <div class="highlight"><pre>        setupSequence.add( self, self.setContentModuleSizes, self.sequencerSpeed ); <span class="comment">// set content module sizes        </span>
        setupSequence.add( self, self.setScrollerOptions, self.sequencerSpeed + <span class="number">200</span> ); <span class="comment">// set scroller &amp; iscroll options</span>
        setupSequence.add( self, self.createScroller, self.sequencerSpeed ); <span class="comment">// create scroller instance</span>

        <span class="keyword">if</span>(self.mode === <span class="string">'tablet'</span>){
</pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>adjusts margins after content modules are absolute positioned</p>             </td>             <td class="code">               <div class="highlight"><pre>          setupSequence.add( self, self.adjustMargins, self.sequencerSpeed ); 
        }

        setupSequence.start();
      },

</pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>teardown controller</p>             </td>             <td class="code">               <div class="highlight"><pre>      teardown : <span class="keyword">function</span>(){
        <span class="keyword">var</span> self         = <span class="keyword">this</span>,
        teardownSequence = <span class="keyword">new</span> Sequencer();

</pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>teardown sequence</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="keyword">if</span>(self.mode == <span class="string">'desktop'</span>){
          teardownSequence.add( self, self.removeStyleAttr, self.sequencerSpeed ); <span class="comment">// remove scroller-specific style attributes</span>
        }

        teardownSequence.add( self, self.destroyScroller, self.sequencerSpeed ); <span class="comment">// destroy scroller instance</span>
        teardownSequence.add( self, self.setMode, self.sequencerSpeed ); <span class="comment">// destroy scroller instance     </span>
        teardownSequence.start();
      },
      
</pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>Hide scroller content for transition   </p>             </td>             <td class="code">               <div class="highlight"><pre>      hideAll : <span class="keyword">function</span>(){
        <span class="keyword">var</span> self = <span class="keyword">this</span>;

        <span class="keyword">var</span> hideSequence = <span class="keyword">new</span> Sequencer();
        hideSequence.add( self, self.hideElements, self.sequencerSpeed ); <span class="comment">// hide elements</span>
        hideSequence.add( self, self.showLoader, self.sequencerSpeed ); <span class="comment">// show loader</span>
        hideSequence.start();
      },

</pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>Show scroller content after transition</p>             </td>             <td class="code">               <div class="highlight"><pre>      showAll : <span class="keyword">function</span>(){
        <span class="keyword">var</span> self = <span class="keyword">this</span>;

        <span class="keyword">var</span> showSequence = <span class="keyword">new</span> Sequencer();
        showSequence.add( self, self.hideLoader, self.sequencerSpeed ); <span class="comment">//hide loader</span>
        showSequence.add( self, self.showElements, self.sequencerSpeed); <span class="comment">// show elements after resize is done                </span>
        showSequence.add( self, self.updateIQ, self.sequencerSpeed + <span class="number">200</span> ); <span class="comment">// update iq</span>
        showSequence.start();
      },

</pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>show loading animation layer</p>             </td>             <td class="code">               <div class="highlight"><pre>      showLoader : <span class="keyword">function</span>(  ){
        <span class="keyword">var</span> self = <span class="keyword">this</span>;
        self.$loader.show();
      },

</pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p>hide loading animation layer</p>             </td>             <td class="code">               <div class="highlight"><pre>      hideLoader : <span class="keyword">function</span>(  ){
        <span class="keyword">var</span> self = <span class="keyword">this</span>;
        self.$loader.hide();
      },

</pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>reload images for iQ</p>             </td>             <td class="code">               <div class="highlight"><pre>      updateIQ : <span class="keyword">function</span>(){
        <span class="keyword">var</span> self = <span class="keyword">this</span>;
        window.iQ.update();               
      },

</pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <p>hide $elements: opacity &amp; visibility </p>             </td>             <td class="code">               <div class="highlight"><pre>      hideElements : <span class="keyword">function</span>(){
        <span class="keyword">var</span> self  = <span class="keyword">this</span>,
        $els = self.$hideShowEls;

</pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <p>TODO: expand this out      </p>             </td>             <td class="code">               <div class="highlight"><pre>        $els.stop(<span class="literal">true</span>,<span class="literal">true</span>).animate({ opacity: <span class="number">0</span> },{ duration: self.hideShowSpeed , complete: <span class="keyword">function</span>(){$els.css({<span class="string">"visibility"</span>:<span class="string">"hidden"</span>});}});
      },

</pre></div>             </td>           </tr>                               <tr id="section-22">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-22">&#182;</a>               </div>               <p>show $els: opacity &amp; visibility </p>             </td>             <td class="code">               <div class="highlight"><pre>      showElements : <span class="keyword">function</span>(){
        <span class="keyword">var</span> self = <span class="keyword">this</span>,
            $els = self.$hideShowEls;
        
</pre></div>             </td>           </tr>                               <tr id="section-23">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-23">&#182;</a>               </div>               <p>TODO: expand this out</p>             </td>             <td class="code">               <div class="highlight"><pre>        $els.stop(<span class="literal">true</span>,<span class="literal">true</span>).animate({ opacity: <span class="number">1</span> },{ duration: self.hideShowSpeed , complete: <span class="keyword">function</span>(){$els.css({<span class="string">"visibility"</span>:<span class="string">"visible"</span>});}});        
      },

</pre></div>             </td>           </tr>                               <tr id="section-24">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-24">&#182;</a>               </div>               <p>instantiate a scroller </p>             </td>             <td class="code">               <div class="highlight"><pre>      createScroller : <span class="keyword">function</span>(){
        <span class="keyword">var</span> self=<span class="keyword">this</span>;
        self.$scrollerInstance = self.$el.scrollerModule( self.scrollerOptions );
      },

</pre></div>             </td>           </tr>                               <tr id="section-25">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-25">&#182;</a>               </div>               <p>destroy scroller if not in mobile</p>             </td>             <td class="code">               <div class="highlight"><pre>      destroyScroller : <span class="keyword">function</span>(){
        <span class="keyword">var</span> self  = <span class="keyword">this</span>;
      
        self.$scrollerInstance.scrollerModule(<span class="string">'destroy'</span>);
        self.$scrollerInstance = <span class="literal">null</span>;
      },

</pre></div>             </td>           </tr>                               <tr id="section-26">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-26">&#182;</a>               </div>               <p>clean up residual style elements after teardown</p>             </td>             <td class="code">               <div class="highlight"><pre>      removeStyleAttr : <span class="keyword">function</span>(){
        <span class="keyword">var</span> self  = <span class="keyword">this</span>,
        $elements = self.$tccBodyWrapper.add(self.$tccBody).add(self.$contentModules);        
        $elements.removeAttr(<span class="string">'style'</span>); 
      },

</pre></div>             </td>           </tr>                               <tr id="section-27">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-27">&#182;</a>               </div>               <p>set scroller options to be passed to sony-scroller
based on current mode </p>             </td>             <td class="code">               <div class="highlight"><pre>      setScrollerOptions : <span class="keyword">function</span>(){
        <span class="keyword">var</span> self = <span class="keyword">this</span>;
       
</pre></div>             </td>           </tr>                               <tr id="section-28">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-28">&#182;</a>               </div>               <p>all general settings are set as default options      </p>             </td>             <td class="code">               <div class="highlight"><pre>        self.scrollerOptions = self.options;
       
</pre></div>             </td>           </tr>                               <tr id="section-29">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-29">&#182;</a>               </div>               <p>now that we know mode, add it as option.</p>             </td>             <td class="code">               <div class="highlight"><pre>        self.scrollerOptions.fitPerPage = self.mode === <span class="string">'phone'</span> ? <span class="number">1</span> : <span class="number">2</span>; 

</pre></div>             </td>           </tr>                               <tr id="section-30">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-30">&#182;</a>               </div>               <p>TODO: determine why passing this into scroller was casusing issues
when more than one scroller instance was on the page 
bullets would get appended to last instance and oddly 
not respecting encapsulation
self.scrollerOptions.appendBulletsTo = self.containerId + '.tcc-wrapper';</p>             </td>             <td class="code">               <div class="highlight"><pre>      },

</pre></div>             </td>           </tr>                               <tr id="section-31">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-31">&#182;</a>               </div>               <p>determine left and right margin total </p>             </td>             <td class="code">               <div class="highlight"><pre>      getHorizontalMargins : <span class="keyword">function</span>( selector ){
        <span class="keyword">var</span> self = <span class="keyword">this</span>,
            $el  = selector;
      
</pre></div>             </td>           </tr>                               <tr id="section-32">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-32">&#182;</a>               </div>               <p>outer width with margins subtracted by width without margins = margins</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="keyword">return</span> Math.round(Number($el.outerWidth(<span class="literal">true</span>) - $el.outerWidth()));
      },

</pre></div>             </td>           </tr>                               <tr id="section-33">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-33">&#182;</a>               </div>               <p>every resize event (debounced) determine size of each content module </p>             </td>             <td class="code">               <div class="highlight"><pre>      setContentModuleSizes : <span class="keyword">function</span>(){     
        <span class="keyword">var</span> self         = <span class="keyword">this</span>,
        containerSize    = Math.round(self.$el.outerWidth()), <span class="comment">// no margins </span>
        headerLRMargin   = self.getHorizontalMargins(self.$tccHeaderWrapper),
        eachContentWidth = <span class="literal">null</span>,
        $elements        = self.$contentModules;

</pre></div>             </td>           </tr>                               <tr id="section-34">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-34">&#182;</a>               </div>               <p>should only ever be "mobile"</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="keyword">if</span>((self.mode === <span class="string">'tablet'</span>) || (self.mode === <span class="string">'phone'</span>)){          
</pre></div>             </td>           </tr>                               <tr id="section-35">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-35">&#182;</a>               </div>               <p>accounts for margins in container widths to support full-bleed</p>             </td>             <td class="code">               <div class="highlight"><pre>          eachContentWidth = containerSize - headerLRMargin;
        
</pre></div>             </td>           </tr>                               <tr id="section-36">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-36">&#182;</a>               </div>               <p>tablet is 2-up not 1-up, so split evenly</p>             </td>             <td class="code">               <div class="highlight"><pre>          <span class="keyword">if</span>(self.mode === <span class="string">'tablet'</span>){
             
</pre></div>             </td>           </tr>                               <tr id="section-37">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-37">&#182;</a>               </div>               <p>accounts for margins in between the two content modules (set after scroller instance)</p>             </td>             <td class="code">               <div class="highlight"><pre>             eachContentWidth = Math.round((eachContentWidth / <span class="number">2</span>) - (headerLRMargin/<span class="number">2</span>));

          }<span class="keyword">else</span>{
</pre></div>             </td>           </tr>                               <tr id="section-38">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-38">&#182;</a>               </div>               <p>assumes self.mode = 'phone'</p>             </td>             <td class="code">               <div class="highlight"><pre>                        
</pre></div>             </td>           </tr>                               <tr id="section-39">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-39">&#182;</a>               </div>               <p>check if we need to set width of specific children elements also</p>             </td>             <td class="code">               <div class="highlight"><pre>            $elements = self.addDynamicWidthElements( $elements );
          }

        }

</pre></div>             </td>           </tr>                               <tr id="section-40">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-40">&#182;</a>               </div>               <p>set each width</p>             </td>             <td class="code">               <div class="highlight"><pre>        $elements.each(<span class="keyword">function</span>() {
          $(<span class="keyword">this</span>).innerWidth(eachContentWidth);
        });
      },

</pre></div>             </td>           </tr>                               <tr id="section-41">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-41">&#182;</a>               </div>               <p>checks $elements for specific content type:mode
if there's a match, it adds that element's child ".center-content" to $elements
$elements obj is returned to get width set</p>             </td>             <td class="code">               <div class="highlight"><pre>      addDynamicWidthElements : <span class="keyword">function</span>( $elements ){
        <span class="keyword">var</span> self = <span class="keyword">this</span>;
      
</pre></div>             </td>           </tr>                               <tr id="section-42">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-42">&#182;</a>               </div>               <p>loop through the content modules</p>             </td>             <td class="code">               <div class="highlight"><pre>        $elements.each(<span class="keyword">function</span>() {
          <span class="keyword">var</span> $el = $(<span class="keyword">this</span>),
              modeType = $el.data(<span class="string">"tcc-content-type"</span>) + <span class="string">':'</span> + $el.data(<span class="string">"tcc-content-mode"</span>);

</pre></div>             </td>           </tr>                               <tr id="section-43">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-43">&#182;</a>               </div>               <p>only these two "mode:type" content modules should get added   </p>             </td>             <td class="code">               <div class="highlight"><pre>          <span class="keyword">if</span>((modeType === <span class="string">'flickr:default'</span>) || (modeType === <span class="string">'sonys-voice:instagram'</span>)){
</pre></div>             </td>           </tr>                               <tr id="section-44">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-44">&#182;</a>               </div>               <p>add ".center-content" child to the objects that will get width set</p>             </td>             <td class="code">               <div class="highlight"><pre>            $elements = $elements.add($el.find(<span class="string">".center-content"</span>));
          }
        });

        <span class="keyword">return</span> $elements;
      },

      adjustMargins : <span class="keyword">function</span>(  ){
        <span class="keyword">var</span> self       = <span class="keyword">this</span>,
        headerLRMargin = self.getHorizontalMargins(self.$tccHeaderWrapper),
        $content, newLeft, contentPosition, contentLeft;

        self.$contentModules.each(<span class="keyword">function</span>(i) {
          $content = $(self.$contentModules[i]); <span class="comment">// content module</span>
          contentPosition = $content.position(); <span class="comment">// current position object</span>
          contentLeft = Number(contentPosition.left); <span class="comment">// content module left position</span>
          
          <span class="keyword">if</span>((i === <span class="number">0</span>) || (i === <span class="number">2</span>)){
</pre></div>             </td>           </tr>                               <tr id="section-45">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-45">&#182;</a>               </div>               <p>first / last content module move left</p>             </td>             <td class="code">               <div class="highlight"><pre>            newLeft = Math.round(Number(contentLeft - (headerLRMargin/<span class="number">2</span>)));
          }<span class="keyword">else</span>{
</pre></div>             </td>           </tr>                               <tr id="section-46">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-46">&#182;</a>               </div>               <p>second content module move right</p>             </td>             <td class="code">               <div class="highlight"><pre>            newLeft = Math.round(Number(contentLeft + (headerLRMargin/<span class="number">2</span>)));
          }

</pre></div>             </td>           </tr>                               <tr id="section-47">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-47">&#182;</a>               </div>               <p>set new left position</p>             </td>             <td class="code">               <div class="highlight"><pre>          $content.offset({left:newLeft});
 
        });
      },

</pre></div>             </td>           </tr>                               <tr id="section-48">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-48">&#182;</a>               </div>               <p>on resize event (debounced) determine what to do</p>             </td>             <td class="code">               <div class="highlight"><pre>      handleResize : <span class="keyword">function</span>(){
        <span class="keyword">var</span> self = <span class="keyword">this</span>;
        
</pre></div>             </td>           </tr>                               <tr id="section-49">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-49">&#182;</a>               </div>               <p>update mode at current break point</p>             </td>             <td class="code">               <div class="highlight"><pre>        self.setMode(); 

</pre></div>             </td>           </tr>                               <tr id="section-50">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-50">&#182;</a>               </div>               <p>if the mode is 'phone' or 'tablet' (aka mobile) then proceed</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="keyword">if</span>( self.mode !== <span class="string">'desktop'</span> ){
          
          <span class="keyword">var</span> resizeMobileSequencer = <span class="keyword">new</span> Sequencer();

</pre></div>             </td>           </tr>                               <tr id="section-51">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-51">&#182;</a>               </div>               <p>if there's a scroller set up, add teardown method to the sequence (reset)</p>             </td>             <td class="code">               <div class="highlight"><pre>          <span class="keyword">if</span>( self.$scrollerInstance !== <span class="literal">null</span> ) {
            resizeMobileSequencer.add( self, self.teardown, self.sequencerSpeed ); <span class="comment">// teardown</span>
          }

</pre></div>             </td>           </tr>                               <tr id="section-52">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-52">&#182;</a>               </div>               <p>create a new scroller</p>             </td>             <td class="code">               <div class="highlight"><pre>          resizeMobileSequencer.add( self, self.setup, self.sequencerSpeed + <span class="number">100</span> );
          
</pre></div>             </td>           </tr>                               <tr id="section-53">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-53">&#182;</a>               </div>               <p>show contents again after transition</p>             </td>             <td class="code">               <div class="highlight"><pre>          resizeMobileSequencer.add( self, self.showAll, self.sequencerSpeed + <span class="number">200</span> ); 

</pre></div>             </td>           </tr>                               <tr id="section-54">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-54">&#182;</a>               </div>               <p>start sequence</p>             </td>             <td class="code">               <div class="highlight"><pre>          resizeMobileSequencer.start();
          
        }<span class="keyword">else</span>{        
  
</pre></div>             </td>           </tr>                               <tr id="section-55">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-55">&#182;</a>               </div>               <p>if mode is now 'desktop' then simply destroy scroller if there is one</p>             </td>             <td class="code">               <div class="highlight"><pre>          <span class="keyword">if</span>( self.$scrollerInstance !== <span class="literal">null</span> ){        
            self.teardown();
            self.showAll();
          }
        }
      },

</pre></div>             </td>           </tr>                               <tr id="section-56">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-56">&#182;</a>               </div>               <p>set mode based on current breakpoint</p>             </td>             <td class="code">               <div class="highlight"><pre>      setMode : <span class="keyword">function</span>(){
        <span class="keyword">var</span> self = <span class="keyword">this</span>;

        <span class="keyword">if</span>( Modernizr.mq(<span class="string">'(max-width:'</span>+ self.phoneBreakpoint+<span class="string">'px)'</span>) ){
          self.mode = <span class="string">'phone'</span>;
        }<span class="keyword">else</span> <span class="keyword">if</span> ( Modernizr.mq(<span class="string">'(min-width:'</span> + self.tabletBreakpointMin + <span class="string">'px) and (max-width:'</span> + self.tabletBreakpointMax + <span class="string">'px)'</span>) ) {
          self.mode = <span class="string">'tablet'</span>;
        }<span class="keyword">else</span>{
          self.mode = <span class="string">'desktop'</span>;
        }
      }
    };

</pre></div>             </td>           </tr>                               <tr id="section-57">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-57">&#182;</a>               </div>               <p>Plugin definition</p>             </td>             <td class="code">               <div class="highlight"><pre>    $.fn.tertiaryModule = <span class="keyword">function</span>( options ) {
      <span class="keyword">var</span> args = Array.prototype.slice.call( arguments, <span class="number">1</span> );
      <span class="keyword">return</span> <span class="keyword">this</span>.each(<span class="keyword">function</span>() {
        <span class="keyword">var</span> self = $(<span class="keyword">this</span>),
          tertiaryModule = self.data(<span class="string">'tertiaryModule'</span>);
    
</pre></div>             </td>           </tr>                               <tr id="section-58">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-58">&#182;</a>               </div>               <p>If we don't have a stored tertiaryModule, make a new one and save it</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="keyword">if</span> ( !tertiaryModule ) {
            tertiaryModule = <span class="keyword">new</span> TertiaryModule( self, options );
            self.data( <span class="string">'tertiaryModule'</span>, tertiaryModule );
        }
    
        <span class="keyword">if</span> ( <span class="keyword">typeof</span> options === <span class="string">'string'</span> ) {
          tertiaryModule[ options ].apply( tertiaryModule, args );
        }
      });
    };

</pre></div>             </td>           </tr>                               <tr id="section-59">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-59">&#182;</a>               </div>               <p>Defaults options for the module</p>             </td>             <td class="code">               <div class="highlight"><pre>    $.fn.tertiaryModule.defaults = {
      options : {
        contentSelector: <span class="string">".tcc-body"</span>, 
        itemElementSelector: <span class="string">".tcc-content-module"</span>, 
        mode: <span class="string">'paginate'</span>,
        generatePagination: <span class="literal">true</span>,
        generateNav:<span class="literal">true</span>,
        centerItems: <span class="literal">true</span>,

        iscrollProps: {
          snap: <span class="literal">true</span>,
          momentum: <span class="literal">false</span>,
          hScrollbar: <span class="literal">false</span>,
          vScrollbar: <span class="literal">false</span>
        }
      }
    };

</pre></div>             </td>           </tr>                               <tr id="section-60">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-60">&#182;</a>               </div>               <p>Non override-able settings</p>             </td>             <td class="code">               <div class="highlight"><pre>    $.fn.tertiaryModule.settings = {
      isTouch: !!( <span class="string">'ontouchstart'</span> <span class="keyword">in</span> window ),
      isInitialized: <span class="literal">false</span>
    };

    $( <span class="keyword">function</span>(){
      $(<span class="string">'.tcc-wrapper'</span>).each(<span class="keyword">function</span>() {
        $(<span class="keyword">this</span>).tertiaryModule({}).data(<span class="string">'tertiaryModule'</span>);
      });
    } );

 })(jQuery, Modernizr, window, <span class="literal">undefined</span>);

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 