<!DOCTYPE html>  <html> <head>   <title>jodo.rangecontrol.1.4.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="brightcove-builder.html">                 brightcove-builder.js               </a>                                           <a class="source" href="editorial-dual-viewer-e9.html">                 editorial-dual-viewer-e9.js               </a>                                           <a class="source" href="form-actions.html">                 form-actions.js               </a>                                           <a class="source" href="hotspot_explorer.html">                 hotspot_explorer.js               </a>                                           <a class="source" href="jquery.viewport.html">                 jquery.viewport.js               </a>                                           <a class="source" href="primary-tout-p1-d7.html">                 primary-tout-p1-d7.js               </a>                                           <a class="source" href="related-products.html">                 related-products.js               </a>                                           <a class="source" href="sony-gallery.html">                 sony-gallery.js               </a>                                           <a class="source" href="sony-one-carousel.html">                 sony-one-carousel.js               </a>                                           <a class="source" href="sony-sequencer.html">                 sony-sequencer.js               </a>                                           <a class="source" href="spec-multi-z2.html">                 spec-multi-z2.js               </a>                                           <a class="source" href="spec-single-z1.html">                 spec-single-z1.js               </a>                                           <a class="source" href="tertiary-t1-t5-module.html">                 tertiary-t1-t5-module.js               </a>                                           <a class="source" href="ux-marketing-convergence-e14.html">                 ux-marketing-convergence-e14.js               </a>                                           <a class="source" href="debug_toggle.html">                 debug_toggle.js               </a>                                           <a class="source" href="exports.html">                 exports.js               </a>                                           <a class="source" href="global-init.html">                 global-init.js               </a>                                           <a class="source" href="global-nav.html">                 global-nav.js               </a>                                           <a class="source" href="iq.html">                 iq.js               </a>                                           <a class="source" href="jquery.throttle-debounce.html">                 jquery.throttle-debounce.js               </a>                                           <a class="source" href="sony-iscroll.html">                 sony-iscroll.js               </a>                                           <a class="source" href="jodo.rangecontrol.1.4.html">                 jodo.rangecontrol.1.4.js               </a>                                           <a class="source" href="jquery.shuffle.html">                 jquery.shuffle.js               </a>                                           <a class="source" href="jquery.simpleknob.html">                 jquery.simpleknob.js               </a>                                           <a class="source" href="sony-draggable.html">                 sony-draggable.js               </a>                                           <a class="source" href="sony-evenheights.html">                 sony-evenheights.js               </a>                                           <a class="source" href="sony-scroller.html">                 sony-scroller.js               </a>                                           <a class="source" href="sony-stickytabs.html">                 sony-stickytabs.js               </a>                                           <a class="source" href="sony-tab.html">                 sony-tab.js               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               jodo.rangecontrol.1.4.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <p>------------ jodo ------------
Module : RangeControl
Version : 1.4
Authored: 2011-11-08 by Jason Eberle
Modified: 2012-01-26 by Christopher Mischler
Modified: 2012-12-07 by Glen Cheney</p>

<h2>Dependencies : jQuery 1.7+, <HTML> conditional classes (for custom cursors)</h2>             </td>             <td class="code">               <div class="highlight"><pre><span class="comment">/*
 *	The comment structure is compatible with NaturalDocs for compiling Documentation.
 *	Please keep this in mind if you make any updates.
*/</span>


<span class="comment">/*
	Class: RangeControl
		Adds a draggable 'slider' to a 'rail' (a long skinny div).
*/</span>

<span class="comment">/*
	Group: Constructor
	&gt; RangeControl( $rail, opts )

	Dependencies:
		jQuery 1.7+, &lt;HTML&gt; conditional classes (for custom cursors)

	Parameters:
		opts:
			Possible values to be passed in through the _opts_ parameter

			orientation - (String, Default: 'h'): Horizontal or Vertical.
							Valid values: 'h' or 'v'
			range - (Boolean, Default: false): if true, this will add a second handle for a range controller
			callback - (function, Default: null): function to call every time the slider is moved/updated.
						Returns: currentPositionPct (Integer, current position percent)
			initialValue - (String or Number, Default: 0): Initial handle position.
							Valid values:
								for positioning relative to the rail's total length: '0%' through '100%' ,
								for positioning relative to the rail's origin: the number (in px),
								if 'steps' is enabled, the step number
			initialMin - (String or Number, Default: 0): Initial minimum range handle position
			initialMax - (String or Number, Default: 100%): Initial maximum range handle position
			steps - (Integer, Default: 0): How many 'steps' (stop-points) between start &amp; end
			$ambit - ($Object, Default: null): Element to use as the ambit
						(the colored section along the rail to signify the area 'below' the handle).
						If null or undefined, a new &lt;span/&gt; will be created, with a class
						of 'ambit'.
			$handle - ($Object, Default: null): Element to use as the handle.
						If null or undefined, a new &lt;span/&gt; will be created, with a class
						of 'handle'.
			$minHandle - ($Object, Default: null): Element to use as the handle.
						If null or undefined, a new &lt;span/&gt; will be created, with a class
						of 'handle slidecontrol-min-handle'.
			hideHandle - (Boolean, Default: false): Hides the handle
			hideAmbit - (Boolean, Default: false): Hides the ambit

	Returns:
		jQuery - The jQuery chain
*/</span>

;(<span class="keyword">function</span>($) {
	<span class="string">'use strict'</span>;

	<span class="keyword">var</span> namespace = <span class="string">'rangecontrol'</span>;

	<span class="keyword">var</span> RangeControl = <span class="keyword">function</span>($rail, opts) {
</pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>set up defaults, override with opts.</p>             </td>             <td class="code">               <div class="highlight"><pre>		$.extend(<span class="keyword">this</span>, $.fn.rangeControl.defaults, opts, $.fn.rangeControl.settings);

		<span class="keyword">var</span> th = <span class="keyword">this</span>,

		init = <span class="keyword">function</span>() {
			<span class="keyword">var</span> th = <span class="keyword">this</span>;

</pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>Our container</p>             </td>             <td class="code">               <div class="highlight"><pre>			th.$rail = $rail;

			th.evts.down = ( !th.isTouch ? <span class="string">'mousedown'</span> : <span class="string">'touchstart'</span> ) + <span class="string">'.'</span> + namespace;
			th.evts.move = ( !th.isTouch ? <span class="string">'mousemove'</span> : <span class="string">'touchmove'</span> ) + <span class="string">'.'</span> + namespace;
			th.evts.up = ( !th.isTouch ? <span class="string">'mouseup'</span> : <span class="string">'touchend'</span> ) + <span class="string">'.'</span> + namespace;

</pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>if rail.css position is static, change it to relative.</p>             </td>             <td class="code">               <div class="highlight"><pre>			<span class="keyword">if</span> ( th.$rail.css(<span class="string">'position'</span>) === <span class="string">'static'</span> ) {
				th.$rail.css(<span class="string">'position'</span>, <span class="string">'relative'</span>);
			}

</pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>make sure orientation is either 'v' or 'h' in case an invalid value is passed in.</p>             </td>             <td class="code">               <div class="highlight"><pre>			th.orientation = th.orientation === <span class="string">'v'</span> ? <span class="string">'v'</span> : <span class="string">'h'</span>;
			th.dimension = th.orientation === <span class="string">'h'</span> ? <span class="string">'width'</span> : <span class="string">'height'</span>;
			th.property = th.orientation === <span class="string">'h'</span> ? <span class="string">'left'</span> : <span class="string">'top'</span>;

</pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <ul>
<li>*
Set up the handle</li>
<li>*</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre>
</pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>If $handle is passed in as a jQuery Object, leave it; otherwise, create one.</p>             </td>             <td class="code">               <div class="highlight"><pre>			th.$handle = th.$handle <span class="keyword">instanceof</span> jQuery ? th.$handle : $(<span class="string">'&lt;span/&gt;'</span>, {<span class="string">'class'</span> : <span class="string">'handle'</span>});
			th.$handle.attr(<span class="string">'unselectable'</span>, <span class="string">'on'</span>).css(th.handleCss);

</pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>Create another handle if we're dealing with a range.</p>             </td>             <td class="code">               <div class="highlight"><pre>			<span class="keyword">if</span> ( th.range ) {
				th.$minHandle = th.$minHandle <span class="keyword">instanceof</span> jQuery ? th.$minHandle : $(<span class="string">'&lt;span/&gt;'</span>, {<span class="string">'class'</span> : <span class="string">'handle'</span>});
				th.$minHandle.data(<span class="string">'min'</span>, <span class="literal">true</span>).addClass(namespace + <span class="string">'-min-handle'</span>).attr(<span class="string">'unselectable'</span>, <span class="string">'on'</span>).css(th.handleCss);
				th.$handle.data(<span class="string">'max'</span>, <span class="literal">true</span>).addClass(namespace + <span class="string">'-max-handle'</span>);
			}

</pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>If the handle doesn't already exist inside of $rail, append it.</p>             </td>             <td class="code">               <div class="highlight"><pre>			<span class="keyword">if</span> ( th.$rail.find(th.$handle).length === <span class="number">0</span>) {
				th.$rail.append(th.$handle);
				<span class="keyword">if</span> ( th.range ) {
					th.$rail.append( th.$minHandle );
				}
			}


</pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>If the value passed in for $handle is false, we want it to function the same, so we have to leave the
handle there; we'll just make it invisible.
In this case, only the $ambit will be visible. If that's disabled, too, the user's SOL.</p>             </td>             <td class="code">               <div class="highlight"><pre>			<span class="keyword">if</span> ( th.hideHandle ) {
				th.$handle.css({
					<span class="string">'opacity'</span>: <span class="string">'0'</span>,
					<span class="string">'background'</span>: <span class="string">'none'</span>,
					<span class="string">'border'</span>: <span class="string">'none'</span>
				});
			}
			<span class="keyword">if</span> ( th.hideHandle &amp;&amp; th.hideAmbit ) {
				console.warn(<span class="string">'**HEY!** $handle and $ambit can\'t both be false!'</span>);
			}


</pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>As long as $ambit isn't false (null, true, a jQuery obj), we need one.
If it's passed in as a jQuery Object, use that. Otherwise create a new one.</p>             </td>             <td class="code">               <div class="highlight"><pre>			<span class="keyword">if</span> ( !th.hideAmbit ) {
				th.$ambit = th.$ambit <span class="keyword">instanceof</span> jQuery ? th.$ambit : $(<span class="string">'&lt;span/&gt;'</span>, {<span class="string">'class'</span> : <span class="string">'ambit'</span>});

				<span class="keyword">if</span> ( th.$rail.find(th.$ambit).length === <span class="number">0</span>) {
					th.$rail.append(th.$ambit);
				}

				th.$ambit.css({
					<span class="string">'display'</span> : <span class="string">'block'</span>,
					<span class="string">'position'</span> : <span class="string">'absolute'</span>
				}).css( th.property, <span class="number">0</span> );
			} <span class="keyword">else</span> {
				th.$ambit = <span class="literal">false</span>;
			}

		},

		events = <span class="keyword">function</span>() {
			<span class="keyword">var</span> $handles = th.range ? th.$handle.add(th.$minHandle) : th.$handle,
				$body = $(<span class="string">'body'</span>);

</pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>Make sure the handle doesn't get a selected-text highlight</p>             </td>             <td class="code">               <div class="highlight"><pre>			$handles.on(<span class="string">'selectstart dragstart mousedown'</span>, <span class="keyword">function</span>() {
				<span class="keyword">return</span> <span class="literal">false</span>;
			});

</pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <ul>
<li>*
Set up handle events</li>
<li>*</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre>
</pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>User grabs the handle. Begin dragging.</p>             </td>             <td class="code">               <div class="highlight"><pre>			$handles.on( th.evts.down, <span class="keyword">function</span>(downEvt) {
				<span class="keyword">if</span> ( th.inMotion ) {
					<span class="keyword">return</span>;
				}

				downEvt.preventDefault();

				<span class="keyword">var</span> $handle = <span class="keyword">this</span>.className.indexOf(<span class="string">'min'</span>) &gt; -<span class="number">1</span> ? th.$minHandle : th.$handle,
					theClass = !th.range ? <span class="string">''</span> :
						<span class="keyword">this</span>.className.indexOf(<span class="string">'min'</span>) &gt; -<span class="number">1</span> ? <span class="string">'grabbing-min'</span> : <span class="string">'grabbing-max'</span>,
					offset = th.$rail.offset();
				th.inMotion = <span class="literal">true</span>;

				$body.addClass(<span class="string">'grabbing '</span> + theClass);
				$handle.addClass(<span class="string">'grabbed'</span>);
				th.fire( th.evts.start );

</pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>User moves cursor/finger</p>             </td>             <td class="code">               <div class="highlight"><pre>				$(document).on( th.evts.move, <span class="keyword">function</span>(moveEvt) {
					moveEvt.preventDefault();
					<span class="keyword">var</span> touch = th.isTouch ? moveEvt.originalEvent.targetTouches[<span class="number">0</span>] : <span class="literal">null</span>,
					pageX = th.isTouch ? touch.pageX : moveEvt.pageX,
					pageY = th.isTouch ? touch.pageY : moveEvt.pageY,
					position = <span class="number">0</span>;

					<span class="keyword">if</span> ( th.orientation === <span class="string">'h'</span> ) {
						position = pageX - offset.left;
					} <span class="keyword">else</span> {
						position = pageY - offset.top;
					}
					th.slideToPos(position, $handle);
				})

</pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>User lets go</p>             </td>             <td class="code">               <div class="highlight"><pre>				.on( th.evts.up, <span class="keyword">function</span>() {
					$(document).off(<span class="string">'.'</span> + namespace);
					th.inMotion = <span class="literal">false</span>;
					$body.removeClass(<span class="string">'grabbing '</span> + theClass);
					$handles.removeClass(<span class="string">'grabbed'</span>);
					th.fire( th.evts.end );
				});

</pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>User clicks, not click-and-hold.</p>             </td>             <td class="code">               <div class="highlight"><pre>			}).on(<span class="string">'click.'</span> + namespace, <span class="keyword">function</span>(e) {
				e.stopPropagation();
			});

</pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p>User clicks on the rail. Jump the handle to the clicked spot (or nearest step).</p>             </td>             <td class="code">               <div class="highlight"><pre>			th.$rail.on(<span class="string">'click'</span>, <span class="keyword">function</span>(e) {
				<span class="keyword">if</span>(!th.inMotion) {
					<span class="keyword">var</span> offset = th.$rail.offset();

					<span class="keyword">var</span> slideTo;
					<span class="keyword">if</span> (th.orientation === <span class="string">'h'</span>) {
						slideTo = e.pageX - offset.left;
					} <span class="keyword">else</span> {
						slideTo = e.pageY - offset.top;
					}
					th.slideToPos(slideTo);
				}
			});


</pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>Update the rail size on window resize</p>             </td>             <td class="code">               <div class="highlight"><pre>			$(window).on(<span class="string">'resize.'</span> + namespace, <span class="keyword">function</span>() {
				th.refresh(<span class="literal">false</span>);
			});
		};

</pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <p>Set up handles and ambit</p>             </td>             <td class="code">               <div class="highlight"><pre>		init.call(th);

</pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <p>Add events to handles and abmit</p>             </td>             <td class="code">               <div class="highlight"><pre>		events.call(th);

</pre></div>             </td>           </tr>                               <tr id="section-22">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-22">&#182;</a>               </div>               <p>Set the rail size, step size, visibility, and handle positions to initial states</p>             </td>             <td class="code">               <div class="highlight"><pre>		th.reset(<span class="literal">true</span>);
	};

	RangeControl.prototype.slideToInitialPos = <span class="keyword">function</span>() {
		<span class="keyword">var</span> th = <span class="keyword">this</span>;
		<span class="keyword">if</span> ( !th.range ) {
			th.slideToInitialVal();
		} <span class="keyword">else</span> {
			th.slideToInitialMin();
			th.slideToInitialMax();
		}
	};

	RangeControl.prototype.slideToInitialVal = <span class="keyword">function</span>() {
		<span class="keyword">this</span>.slideToPos( <span class="keyword">this</span>.parseHandlePosition( <span class="keyword">this</span>.initialValue ) );
	};

	RangeControl.prototype.slideToInitialMin = <span class="keyword">function</span>() {
		<span class="keyword">this</span>.slideToPos( <span class="keyword">this</span>.parseHandlePosition( <span class="keyword">this</span>.initialMin ), <span class="keyword">this</span>.$minHandle );
	};

	RangeControl.prototype.slideToInitialMax = <span class="keyword">function</span>() {
		<span class="keyword">this</span>.slideToPos( <span class="keyword">this</span>.parseHandlePosition( <span class="keyword">this</span>.initialMax ), <span class="keyword">this</span>.$handle );
	};

	<span class="comment">/*
		Method: parseHandlePosition
			Parses the position (in pixels) where the handle should be based on user input

		Returns:
			Int - pixel value for position
	*/</span>
	RangeControl.prototype.parseHandlePosition = <span class="keyword">function</span>(input) {
		<span class="keyword">var</span> th = <span class="keyword">this</span>,
		pixels = <span class="number">0</span>;

</pre></div>             </td>           </tr>                               <tr id="section-23">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-23">&#182;</a>               </div>               <p>Set up initial position of the handle, based on initialValue.
if initialValue is a number:</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="keyword">if</span> ( $.type(input) === <span class="string">'number'</span> &amp;&amp; input ) {
</pre></div>             </td>           </tr>                               <tr id="section-24">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-24">&#182;</a>               </div>               <p>slideToPos: if 'steps' is enabled, slide to that step; otherwise slide to that px position.</p>             </td>             <td class="code">               <div class="highlight"><pre>			pixels = input * (th.steps ? th.stepSize : <span class="number">1</span>);

</pre></div>             </td>           </tr>                               <tr id="section-25">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-25">&#182;</a>               </div>               <p>if initialValue is a string:</p>             </td>             <td class="code">               <div class="highlight"><pre>		} <span class="keyword">else</span> <span class="keyword">if</span> ( $.type(input) === <span class="string">'string'</span> ) {
</pre></div>             </td>           </tr>                               <tr id="section-26">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-26">&#182;</a>               </div>               <p>if initialValue contains 'px', convert it to an Integer &amp; slide to that absolute position.
this will ignore whether 'steps' is enabled.</p>             </td>             <td class="code">               <div class="highlight"><pre>			<span class="keyword">if</span> ( input.indexOf(<span class="string">'px'</span>) &gt; -<span class="number">1</span> ) {
				pixels = parseInt( input, <span class="number">10</span> );

</pre></div>             </td>           </tr>                               <tr id="section-27">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-27">&#182;</a>               </div>               <p>if initialValue ends with a % sign, convert it to an Integer &amp; slide to that relative position.</p>             </td>             <td class="code">               <div class="highlight"><pre>			} <span class="keyword">else</span> <span class="keyword">if</span> ( input.indexOf(<span class="string">'%'</span>) &gt; -<span class="number">1</span> ) {
				pixels = th.railSize * ( parseInt( input, <span class="number">10</span> ) / <span class="number">100</span>);
			}
		}

		<span class="keyword">return</span> pixels;
	};

	<span class="comment">/*
		Group: Methods
	*/</span>
	<span class="comment">/*
		Method: slideToPos
			Move the handle &amp; expand the ambit to the position (in pixels) in newPos.
			Will be called when clicking on the rail, or on mousemove while dragging the handle.
			If 'steps' was enabled, the number passed to slideToPos has already been set to the step location.

		Parameters:
			newPos - (Integer, in px, Required): New target position of the handle, based on the target position
						relative to the zero position (top/left) of the rail.

		Returns:
			RangeControl - .
	*/</span>
	RangeControl.prototype.slideToPos = <span class="keyword">function</span>(newPos, $handle) {
		$handle = $handle || <span class="keyword">this</span>.$handle;

		<span class="keyword">var</span> th = <span class="keyword">this</span>,
		data = {},
		isMin = $handle.data(<span class="string">'min'</span>) === <span class="literal">true</span>,
		curStep, newStep,

		getStep = <span class="keyword">function</span>(pos) {
			<span class="keyword">return</span> Math.round(pos / th.stepSize);
		};

</pre></div>             </td>           </tr>                               <tr id="section-28">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-28">&#182;</a>               </div>               <p>Make sure the new position is valid</p>             </td>             <td class="code">               <div class="highlight"><pre>		newPos = th.validatePos(newPos, isMin);

		<span class="keyword">if</span> ( th.steps ) {
			curStep = getStep(th.currentPosition);
			newStep = getStep(newPos);
			data = {
				oldStep : curStep,
				newStep : newStep,
				stepDelta : newStep - curStep
			};

			newPos = newStep * th.stepSize;

			<span class="keyword">if</span> (data.stepDelta) {
				th.goToPos(newPos, $handle, data);
			}
		} <span class="keyword">else</span> {
			data = {
				oldPosition : th.currentPosition,
				newPosition : newPos,
				positionDelta : newPos - th.currentPosition
			};

			th.goToPos(newPos, $handle, isMin);
		}

		<span class="keyword">return</span> th;
	};

	<span class="comment">/*
		Method: validatePos
			Makes sure the new position is valid

		Parameters:
			newPos - (Integer, in px, Required): New target position of the handle, based on the target position
						relative to the zero position (top/left) of the rail.
			isMin - (Boolean, Optional): true if the currently dragged handle is the minimum handle

		Returns:
			Int - a parsed and validated position in pixels.
	*/</span>
	RangeControl.prototype.validatePos = <span class="keyword">function</span>(newPos, isMin) {
		<span class="keyword">var</span> th = <span class="keyword">this</span>;
</pre></div>             </td>           </tr>                               <tr id="section-29">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-29">&#182;</a>               </div>               <p>Parse and validate pos</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="keyword">if</span> ( newPos &lt; <span class="number">0</span> ) {
			newPos = <span class="number">0</span>;
		}
		<span class="keyword">if</span> ( newPos &gt; th.railSize ) {
			newPos = th.railSize;
		}

</pre></div>             </td>           </tr>                               <tr id="section-30">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-30">&#182;</a>               </div>               <p>Don't let range values go past the other</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="keyword">if</span> ( th.range ) {
			<span class="keyword">if</span> ( isMin ) {
				<span class="keyword">if</span> ( th.currentPosition !== <span class="literal">false</span> &amp;&amp; newPos &gt; th.currentPosition ) {
					newPos = th.currentPosition;
				}
			} <span class="keyword">else</span> {
				<span class="keyword">if</span> ( th.currentMinPosition !== <span class="literal">false</span> &amp;&amp; newPos &lt; th.currentMinPosition) {
					newPos = th.currentMinPosition;
				}
			}
		}

		<span class="keyword">return</span> newPos;
	};

	<span class="comment">/*
		Method: goToPos
			Handles logic for moving handles to the correct positions. This function should only be called from slideToPos

		Parameters:
			pos - (Integer, in px, Required): New target position of the handle, based on the target position
						relative to the zero position (top/left) of the rail.
			$handle - (jQuery object, Required): jQuery object representing the current handle
			data - (Object, Required): data passed to the event that is triggered

		Returns:
			RangeControl - .
	*/</span>
	RangeControl.prototype.goToPos = <span class="keyword">function</span>(pos, $handle, isMin) {
		<span class="keyword">var</span> th = <span class="keyword">this</span>,
			response = [];

		$handle[<span class="number">0</span>].style[ th.property ] = ( pos / th.railSize * <span class="number">100</span> ) + <span class="string">'%'</span>;
		<span class="keyword">if</span> ( isMin ) {
			th.lastMinPosition = pos;
		} <span class="keyword">else</span> {
			th.lastPosition = pos;
		}

		<span class="keyword">if</span> ( !th.range ) {
			th.currentPosition = th.lastPosition;
			th.currentPositionPct = th.lastPosition / th.railSize * <span class="number">100</span>;

</pre></div>             </td>           </tr>                               <tr id="section-31">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-31">&#182;</a>               </div>               <p>Range control
Calculate position values</p>             </td>             <td class="code">               <div class="highlight"><pre>		} <span class="keyword">else</span> {

</pre></div>             </td>           </tr>                               <tr id="section-32">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-32">&#182;</a>               </div>               <p>If the plugin is being intialized, but it is hidden, our calculated values will be wrong. Use initial ones.
To update isHidden, call .rangeControl('refresh') when the visibility changes</p>             </td>             <td class="code">               <div class="highlight"><pre>			<span class="keyword">if</span> ( th.isHidden ) {
				th.currentPosition = th.parseHandlePosition( th.initialMax );
				th.currentMinPosition = th.parseHandlePosition( th.initialMin );

</pre></div>             </td>           </tr>                               <tr id="section-33">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-33">&#182;</a>               </div>               <p>Else get the position from our last position</p>             </td>             <td class="code">               <div class="highlight"><pre>			} <span class="keyword">else</span> {
</pre></div>             </td>           </tr>                               <tr id="section-34">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-34">&#182;</a>               </div>               <p>lastPosition is initialized at false</p>             </td>             <td class="code">               <div class="highlight"><pre>				th.currentPosition = th.lastPosition !== <span class="literal">false</span> ? th.lastPosition : th.parseHandlePosition( th.$handle.css( th.property ), <span class="number">10</span> );
				th.currentMinPosition = th.lastMinPosition !== <span class="literal">false</span> ? th.lastMinPosition : th.parseHandlePosition( th.$minHandle.css( th.property ), <span class="number">10</span> );
			}
			th.currentPositionPct = Math.min( th.currentPosition / th.railSize * <span class="number">100</span>, <span class="number">100</span> ); <span class="comment">// don't let it go above 100</span>
			th.currentMinPositionPct = Math.min( th.currentMinPosition / th.railSize * <span class="number">100</span>, <span class="number">100</span> );


</pre></div>             </td>           </tr>                               <tr id="section-35">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-35">&#182;</a>               </div>               <p>Make sure we can get to 100% and 0%</p>             </td>             <td class="code">               <div class="highlight"><pre>			<span class="keyword">if</span> ( th.currentPositionPct &gt; <span class="number">99.49</span> ) {
				th.currentPositionPct = <span class="number">100</span>;
			} <span class="keyword">else</span> <span class="keyword">if</span> ( th.currentPositionPct &lt; <span class="number">0.5</span> ) {
				th.currentPositionPct = <span class="number">0</span>;
			}
			<span class="keyword">if</span> ( th.currentMinPositionPct &gt; <span class="number">99.49</span> ) {
				th.currentMinPositionPct = <span class="number">100</span>;
			} <span class="keyword">else</span> <span class="keyword">if</span> ( th.currentMinPositionPct &lt; <span class="number">0.5</span> ) {
				th.currentMinPositionPct = <span class="number">0</span>;
			}

</pre></div>             </td>           </tr>                               <tr id="section-36">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-36">&#182;</a>               </div>               <p>Change ambit's width/height and left/top</p>             </td>             <td class="code">               <div class="highlight"><pre>			th.$ambit[ th.dimension ]( th.getHandleDist() + <span class="string">'%'</span> );
			th.$ambit.css( th.property, th.currentMinPositionPct + <span class="string">'%'</span> );
		}

		<span class="keyword">if</span> ( th.$ambit &amp;&amp; !th.range ) {
			th.$ambit[ th.dimension ]( th.currentPositionPct + <span class="string">'%'</span> );
		}

</pre></div>             </td>           </tr>                               <tr id="section-37">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-37">&#182;</a>               </div>               <p>Build response for slid event</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="keyword">if</span> ( th.range ) {
			response = [{
					min: th.currentMinPosition,
					max: th.currentPosition
				},{
					min: th.currentMinPositionPct,
					max: th.currentPositionPct
				},
				th
			];
		} <span class="keyword">else</span> {
			response = [ th.currentPositionPct, th ];
		}

</pre></div>             </td>           </tr>                               <tr id="section-38">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-38">&#182;</a>               </div>               <p>Trigger slid event</p>             </td>             <td class="code">               <div class="highlight"><pre>		th.fire( th.evts.slid, response );

		<span class="keyword">return</span> th;
	};

	<span class="comment">/*
		Method: getHandleDist
			Gets the distance between the minimum and maximum handles (in percent)

		Returns:
			Float
	*/</span>
	RangeControl.prototype.getHandleDist = <span class="keyword">function</span>() {
		<span class="keyword">var</span> th = <span class="keyword">this</span>,
</pre></div>             </td>           </tr>                               <tr id="section-39">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-39">&#182;</a>               </div>               <p>Access the style property to ensure the return value is a percent</p>             </td>             <td class="code">               <div class="highlight"><pre>		dist = parseFloat( th.$handle[<span class="number">0</span>].style[ th.property ] ) - parseFloat( th.$minHandle[<span class="number">0</span>].style[ th.property ] );
		<span class="keyword">return</span> dist;
	};

	<span class="comment">/*
		Method: slideToStep
			Move the handle &amp; expand the ambit to the designated 'step' position.

		Parameters:
			step - (Integer, Required): New target position of the handle, based on the cursor position
					relative to the zero position (top/left) of the rail.

		Returns:
			RangeControl - .
	*/</span>
	RangeControl.prototype.slideToStep = <span class="keyword">function</span>(step) {
		<span class="keyword">this</span>.slideToPos( step * (<span class="keyword">this</span>.steps ? <span class="keyword">this</span>.stepSize : <span class="number">1</span>) );

		<span class="keyword">return</span> <span class="keyword">this</span>;
	};

	<span class="comment">/*
		Method: updateSize
			Set up the initial positioning &amp; values for railSize &amp; stepSize, based on width (for horizontal)
			or height (for vertical) of rail.

		Parameters:
			andHandles - if true, the function will update the position of the handles

		Returns:
			RangeControl - .

	*/</span>
	RangeControl.prototype.updateSize = <span class="keyword">function</span>( andHandles ) {
		<span class="keyword">var</span> th = <span class="keyword">this</span>,
			size;

</pre></div>             </td>           </tr>                               <tr id="section-40">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-40">&#182;</a>               </div>               <p>Get the size of the rail</p>             </td>             <td class="code">               <div class="highlight"><pre>		size = th.orientation === <span class="string">'h'</span> ? th.$rail.outerWidth() : th.$rail.outerHeight();

</pre></div>             </td>           </tr>                               <tr id="section-41">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-41">&#182;</a>               </div>               <p>Only make continue if the size has actually changed</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="keyword">if</span> ( size !== th.railSize ) {
			th.railSize = size || th.railSize; <span class="comment">// the rail size could have been reset to 0 if it's hidden on resize</span>

</pre></div>             </td>           </tr>                               <tr id="section-42">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-42">&#182;</a>               </div>               <p>Calcualte stepSize based on railSize &amp; # of steps.</p>             </td>             <td class="code">               <div class="highlight"><pre>			<span class="keyword">if</span> ( th.steps ) {
				th.stepSize = th.railSize / th.steps;
			}

			<span class="keyword">if</span> ( andHandles !== <span class="literal">false</span> ) {
				th.slideToPos( th.currentPosition );
				<span class="keyword">if</span> ( th.range ) {
					th.slideToPos( th.currentMinPosition, th.$minHandle );
				}
			}
		}


		<span class="keyword">return</span> th;
	};

	RangeControl.prototype.fire = <span class="keyword">function</span>( name, args ) {
		<span class="keyword">this</span>.$rail.trigger( name + <span class="string">'.'</span> + namespace, args || [<span class="keyword">this</span>] );
	};

	<span class="comment">/*
		Method: refresh
			Updates sizing values

		Returns:
			RangeControl - .

	*/</span>
	RangeControl.prototype.refresh = <span class="keyword">function</span>( andHandles ) {
		<span class="keyword">var</span> th = <span class="keyword">this</span>;

</pre></div>             </td>           </tr>                               <tr id="section-43">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-43">&#182;</a>               </div>               <p>If the rail is not visible, there may be some sizing issues</p>             </td>             <td class="code">               <div class="highlight"><pre>		th.isHidden = th.$rail.is(<span class="string">':hidden'</span>);

</pre></div>             </td>           </tr>                               <tr id="section-44">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-44">&#182;</a>               </div>               <p>Get the size of the rail</p>             </td>             <td class="code">               <div class="highlight"><pre>		th.updateSize( andHandles );

		<span class="keyword">return</span> <span class="keyword">this</span>;
	};

</pre></div>             </td>           </tr>                               <tr id="section-45">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-45">&#182;</a>               </div>               <p>Resest sizing and handle positions</p>             </td>             <td class="code">               <div class="highlight"><pre>	RangeControl.prototype.reset = <span class="keyword">function</span>( isHardReset ) {
		<span class="keyword">var</span> th = <span class="keyword">this</span>,
			hasPercent = th.$handle[<span class="number">0</span>].style[ th.property ].indexOf(<span class="string">'%'</span>) &gt; -<span class="number">1</span>;


</pre></div>             </td>           </tr>                               <tr id="section-46">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-46">&#182;</a>               </div>               <p>Set the rail size, step size, and visibility</p>             </td>             <td class="code">               <div class="highlight"><pre>		th.refresh(<span class="literal">false</span>);

</pre></div>             </td>           </tr>                               <tr id="section-47">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-47">&#182;</a>               </div>               <p>The handle's left|top value would be a percentage if slideToPos was already called on that handle
We can use this to determine if we've already initialized the handle</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="keyword">if</span> ( isHardReset || !hasPercent ) {
</pre></div>             </td>           </tr>                               <tr id="section-48">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-48">&#182;</a>               </div>               <p>Give handles initial values</p>             </td>             <td class="code">               <div class="highlight"><pre>			th.slideToInitialPos();
		} <span class="keyword">else</span> {
			<span class="keyword">if</span> ( !th.range ) {
				th.slideToPos( th.parseHandlePosition( th.$handle[<span class="number">0</span>].style[ th.property ] ) );
			} <span class="keyword">else</span> {
				th.slideToPos( th.parseHandlePosition( th.$minHandle[<span class="number">0</span>].style[ th.property ] ), th.$minHandle );
				th.slideToPos( th.parseHandlePosition( th.$handle[<span class="number">0</span>].style[ th.property ] ), th.$handle );
			}
		}
	};


	RangeControl.prototype.destroy = <span class="keyword">function</span>() {
		<span class="keyword">var</span> th = <span class="keyword">this</span>;

		th.$rail.empty().removeData(<span class="string">'rangeControl'</span>);
	};


	<span class="comment">/*
		Group: jQuery Plugin Wrapper
	*/</span>
	<span class="comment">/*
		Method: $.fn.rangeControl
			jQuery Plugin Wrapper for RangeControl

		Parameters:
			opts - (Plain js Object, Default: {} ): Used to pass in custom options.

		opts:
			Possible values to be passed in through the _opts_ parameter

			orientation - (String, Default: 'h'): Horizontal or Vertical.
							Valid values: 'h' or 'v'
			range - (Boolean, Default: false): if true, this will add a second handle for a range controller
			callback - (function, Default: null): function to call every time the slider is moved/updated.
						Returns: currentPositionPct (Integer, current position percent)
			initialValue - (String or Number, Default: 0): Initial handle position.
							Valid values:
								for positioning relative to the rail's total length: '0%' through '100%' ,
								for positioning relative to the rail's origin: the number (in px),
								if 'steps' is enabled, the step number
			initialMin - (String or Number, Default: 0): Initial minimum range handle position
			initialMax - (String or Number, Default: 100%): Initial maximum range handle position
			steps - (Integer, Default: 0): How many 'steps' (stop-points) between start &amp; end
			$ambit - ($Object, Default: null): Element to use as the ambit
						(the colored section along the rail to signify the area 'below' the handle).
						If null or undefined, a new &lt;span/&gt; will be created, with a class
						of 'ambit'.
			$handle - ($Object, Default: null): Element to use as the handle.
						If null or undefined, a new &lt;span/&gt; will be created, with a class
						of 'handle'.
			$minHandle - ($Object, Default: null): Element to use as the handle.
						If null or undefined, a new &lt;span/&gt; will be created, with a class
						of 'handle slidecontrol-min-handle'.
			hideHandle - (Boolean, Default: false): Hides the handle
			hideAmbit - (Boolean, Default: false): Hides the ambit

		Returns:
			jQuery - The jQuery chain
	*/</span>
	$.fn.rangeControl = <span class="keyword">function</span>(opts) {
		<span class="keyword">var</span> args = Array.prototype.slice.apply( arguments );
		<span class="keyword">return</span> <span class="keyword">this</span>.each(<span class="keyword">function</span>() {
			<span class="keyword">var</span> $<span class="keyword">this</span> = $(<span class="keyword">this</span>),
				rangeControl = $<span class="keyword">this</span>.data(<span class="string">'rangeControl'</span>);

			<span class="keyword">if</span> ( !rangeControl ) {
				rangeControl = <span class="keyword">new</span> RangeControl($<span class="keyword">this</span>, opts);
				$<span class="keyword">this</span>.data(<span class="string">'rangeControl'</span>, rangeControl);
			}

			<span class="keyword">if</span> ( <span class="keyword">typeof</span> opts === <span class="string">'string'</span> ) {
				rangeControl[ opts ].apply( rangeControl, args.slice(<span class="number">1</span>) );
			}
		});
	};

	$.fn.rangeControl.defaults = {
		initialValue : <span class="number">0</span>,
		steps : <span class="number">0</span>,
		orientation : <span class="string">'h'</span>,
		hideHandle : <span class="literal">false</span>,
		hideAmbit : <span class="literal">false</span>,
		$handle : <span class="literal">null</span>,
		$ambit : <span class="literal">null</span>,
		callback : <span class="literal">null</span>,
		range : <span class="literal">false</span>,
		initialMin : <span class="string">'0'</span>,
		initialMax : <span class="string">'100%'</span>
	};

	$.fn.rangeControl.settings = {
		isTouch : !!( <span class="string">'ontouchstart'</span> <span class="keyword">in</span> window ),
		inMotion : <span class="literal">false</span>,
		stepSize : <span class="number">0</span>,
		railSize : <span class="literal">false</span>,
		currentPosition : <span class="literal">false</span>,
		currentPositionPct : <span class="literal">false</span>,
		currentMinPosition : <span class="literal">false</span>,
		currentMinPositionPct : <span class="literal">false</span>,
		lastPosition: <span class="literal">false</span>,
		lastMinPosition: <span class="literal">false</span>,
		evts : {
			start : <span class="string">'scrubstart'</span>,
			end : <span class="string">'scrubend'</span>,
			slid : <span class="string">'slid'</span>
		},

		handleCss : {
			<span class="string">'display'</span> : <span class="string">'block'</span>,
			<span class="string">'position'</span> : <span class="string">'absolute'</span>,
			<span class="string">'top'</span> : <span class="number">0</span>,
			<span class="string">'left'</span> : <span class="number">0</span>,
			<span class="string">'MozUserSelect'</span>: <span class="string">'none'</span>,
			<span class="string">'msUserSelect'</span>: <span class="string">'none'</span>,
			<span class="string">'webkitUserSelect'</span>: <span class="string">'none'</span>,
			<span class="string">'userSelect'</span>:<span class="string">'none'</span>
		}
	};
}(jQuery));
</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 